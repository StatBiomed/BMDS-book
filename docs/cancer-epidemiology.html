<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Cancer Epidemiology | Biomedical Data Science - introduction with case studies</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Cancer Epidemiology | Biomedical Data Science - introduction with case studies" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Cancer Epidemiology | Biomedical Data Science - introduction with case studies" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="BIOF1001 teaching team" />


<meta name="date" content="2023-09-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="pop-genetics.html"/>
<link rel="next" href="install.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">Biomedical Data Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#introduction-for-readers"><i class="fa fa-check"></i>Introduction for readers</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#what-we-hope-you-will-learn-from-this-course-book"><i class="fa fa-check"></i>What we hope you will learn from this course / book</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#what-we-recommend-you-do-while-reading-this-book"><i class="fa fa-check"></i>What we recommend you do while reading this book</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#last-notes"><i class="fa fa-check"></i>Last notes</a></li>
</ul></li>
<li class="part"><span><b>I Data Science Foundations</b></span></li>
<li class="chapter" data-level="1" data-path="introR.html"><a href="introR.html"><i class="fa fa-check"></i><b>1</b> Introduction to R programming</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introR.html"><a href="introR.html#data-types"><i class="fa fa-check"></i><b>1.1</b> Data types</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introR.html"><a href="introR.html#nemeric-or-double"><i class="fa fa-check"></i><b>1.1.1</b> nemeric (or double)</a></li>
<li class="chapter" data-level="1.1.2" data-path="introR.html"><a href="introR.html#integer"><i class="fa fa-check"></i><b>1.1.2</b> integer</a></li>
<li class="chapter" data-level="1.1.3" data-path="introR.html"><a href="introR.html#logical"><i class="fa fa-check"></i><b>1.1.3</b> logical</a></li>
<li class="chapter" data-level="1.1.4" data-path="introR.html"><a href="introR.html#character"><i class="fa fa-check"></i><b>1.1.4</b> character</a></li>
<li class="chapter" data-level="1.1.5" data-path="introR.html"><a href="introR.html#memeory-usage"><i class="fa fa-check"></i><b>1.1.5</b> Memeory usage</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introR.html"><a href="introR.html#data-structures"><i class="fa fa-check"></i><b>1.2</b> Data structures</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introR.html"><a href="introR.html#vector"><i class="fa fa-check"></i><b>1.2.1</b> Vector</a></li>
<li class="chapter" data-level="1.2.2" data-path="introR.html"><a href="introR.html#matrix"><i class="fa fa-check"></i><b>1.2.2</b> Matrix</a></li>
<li class="chapter" data-level="1.2.3" data-path="introR.html"><a href="introR.html#list"><i class="fa fa-check"></i><b>1.2.3</b> List</a></li>
<li class="chapter" data-level="1.2.4" data-path="introR.html"><a href="introR.html#data-frame"><i class="fa fa-check"></i><b>1.2.4</b> Data Frame</a></li>
<li class="chapter" data-level="1.2.5" data-path="introR.html"><a href="introR.html#factor-vs-vector"><i class="fa fa-check"></i><b>1.2.5</b> Factor vs vector</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introR.html"><a href="introR.html#read-and-write-files-tables"><i class="fa fa-check"></i><b>1.3</b> Read and write files (tables)</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introR.html"><a href="introR.html#read-file"><i class="fa fa-check"></i><b>1.3.1</b> Read file</a></li>
<li class="chapter" data-level="1.3.2" data-path="introR.html"><a href="introR.html#write-file"><i class="fa fa-check"></i><b>1.3.2</b> Write file</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introR.html"><a href="introR.html#functions-and-packages"><i class="fa fa-check"></i><b>1.4</b> Functions and Packages</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introR.html"><a href="introR.html#install-packages"><i class="fa fa-check"></i><b>1.4.1</b> Install packages</a></li>
<li class="chapter" data-level="1.4.2" data-path="introR.html"><a href="introR.html#apply-function-repeatly"><i class="fa fa-check"></i><b>1.4.2</b> Apply function repeatly</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introR.html"><a href="introR.html#plotting"><i class="fa fa-check"></i><b>1.5</b> Plotting</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="introR.html"><a href="introR.html#datasets"><i class="fa fa-check"></i><b>1.5.1</b> datasets</a></li>
<li class="chapter" data-level="1.5.2" data-path="introR.html"><a href="introR.html#basic-plotting"><i class="fa fa-check"></i><b>1.5.2</b> Basic plotting</a></li>
<li class="chapter" data-level="1.5.3" data-path="introR.html"><a href="introR.html#ggplot2"><i class="fa fa-check"></i><b>1.5.3</b> ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="introR.html"><a href="introR.html#scientific-and-statistical-computating"><i class="fa fa-check"></i><b>1.6</b> Scientific and statistical computating</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="introR.html"><a href="introR.html#orders-of-operators"><i class="fa fa-check"></i><b>1.6.1</b> Orders of operators</a></li>
<li class="chapter" data-level="1.6.2" data-path="introR.html"><a href="introR.html#functions-for-statistics"><i class="fa fa-check"></i><b>1.6.2</b> Functions for statistics</a></li>
<li class="chapter" data-level="1.6.3" data-path="introR.html"><a href="introR.html#correlation"><i class="fa fa-check"></i><b>1.6.3</b> Correlation</a></li>
<li class="chapter" data-level="1.6.4" data-path="introR.html"><a href="introR.html#hypothesis-testing-t-test"><i class="fa fa-check"></i><b>1.6.4</b> Hypothesis testing (t test)</a></li>
<li class="chapter" data-level="1.6.5" data-path="introR.html"><a href="introR.html#regression"><i class="fa fa-check"></i><b>1.6.5</b> Regression</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="introR.html"><a href="introR.html#resource-links"><i class="fa fa-check"></i><b>1.7</b> Resource links</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introLinearReg.html"><a href="introLinearReg.html"><i class="fa fa-check"></i><b>2</b> Introduction to Linear Regression</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introLinearReg.html"><a href="introLinearReg.html#linear-regression-using-simulated-data"><i class="fa fa-check"></i><b>2.1</b> Linear Regression Using Simulated Data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introLinearReg.html"><a href="introLinearReg.html#simulating-data"><i class="fa fa-check"></i><b>2.1.1</b> Simulating data:</a></li>
<li class="chapter" data-level="2.1.2" data-path="introLinearReg.html"><a href="introLinearReg.html#model-efficacy"><i class="fa fa-check"></i><b>2.1.2</b> Model efficacy</a></li>
<li class="chapter" data-level="2.1.3" data-path="introLinearReg.html"><a href="introLinearReg.html#r-squared"><i class="fa fa-check"></i><b>2.1.3</b> <em>R-Squared</em></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introLinearReg.html"><a href="introLinearReg.html#least-squares-using-simulated-data"><i class="fa fa-check"></i><b>2.2</b> Least Squares Using Simulated Data</a></li>
<li class="chapter" data-level="2.3" data-path="introLinearReg.html"><a href="introLinearReg.html#diagnostic-check-of-a-fitted-regression-model"><i class="fa fa-check"></i><b>2.3</b> Diagnostic check of a fitted regression model</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="introLinearReg.html"><a href="introLinearReg.html#residual-standard-errors-rse"><i class="fa fa-check"></i><b>2.3.1</b> Residual Standard Errors (RSE)</a></li>
<li class="chapter" data-level="2.3.2" data-path="introLinearReg.html"><a href="introLinearReg.html#p-values"><i class="fa fa-check"></i><b>2.3.2</b> p-values</a></li>
<li class="chapter" data-level="2.3.3" data-path="introLinearReg.html"><a href="introLinearReg.html#f-statistics"><i class="fa fa-check"></i><b>2.3.3</b> F-statistics</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introLinearReg.html"><a href="introLinearReg.html#simple-linear-regression-with-lm-function"><i class="fa fa-check"></i><b>2.4</b> Simple Linear Regression with <code>lm</code> function</a></li>
<li class="chapter" data-level="2.5" data-path="introLinearReg.html"><a href="introLinearReg.html#multiple-regression-with-lm-function"><i class="fa fa-check"></i><b>2.5</b> Multiple Regression with <code>lm</code> function</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introClassifier.html"><a href="introClassifier.html"><i class="fa fa-check"></i><b>3</b> Introduction to Classification</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introClassifier.html"><a href="introClassifier.html#visualise-logistic-and-logit-functions"><i class="fa fa-check"></i><b>3.1</b> Visualise logistic and logit functions</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="introClassifier.html"><a href="introClassifier.html#logistic-function"><i class="fa fa-check"></i><b>3.1.1</b> Logistic function</a></li>
<li class="chapter" data-level="3.1.2" data-path="introClassifier.html"><a href="introClassifier.html#logit-function"><i class="fa fa-check"></i><b>3.1.2</b> Logit function</a></li>
<li class="chapter" data-level="3.1.3" data-path="introClassifier.html"><a href="introClassifier.html#visualise-the-distribution"><i class="fa fa-check"></i><b>3.1.3</b> Visualise the distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="introClassifier.html"><a href="introClassifier.html#logistic-regression-on-diabetes"><i class="fa fa-check"></i><b>3.2</b> Logistic regression on Diabetes</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="introClassifier.html"><a href="introClassifier.html#load-pima-indians-diabetes-database"><i class="fa fa-check"></i><b>3.2.1</b> Load Pima Indians Diabetes Database</a></li>
<li class="chapter" data-level="3.2.2" data-path="introClassifier.html"><a href="introClassifier.html#fit-logistic-regression"><i class="fa fa-check"></i><b>3.2.2</b> Fit logistic regression</a></li>
<li class="chapter" data-level="3.2.3" data-path="introClassifier.html"><a href="introClassifier.html#assess-on-test-data"><i class="fa fa-check"></i><b>3.2.3</b> Assess on test data</a></li>
<li class="chapter" data-level="3.2.4" data-path="introClassifier.html"><a href="introClassifier.html#model-selection-and-diagnosis"><i class="fa fa-check"></i><b>3.2.4</b> Model selection and diagnosis</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="introClassifier.html"><a href="introClassifier.html#cross-validation"><i class="fa fa-check"></i><b>3.3</b> Cross-validation</a></li>
<li class="chapter" data-level="3.4" data-path="introClassifier.html"><a href="introClassifier.html#more-assessment-metrics"><i class="fa fa-check"></i><b>3.4</b> More assessment metrics</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="introClassifier.html"><a href="introClassifier.html#two-types-of-error"><i class="fa fa-check"></i><b>3.4.1</b> Two types of error</a></li>
<li class="chapter" data-level="3.4.2" data-path="introClassifier.html"><a href="introClassifier.html#roc-curve"><i class="fa fa-check"></i><b>3.4.2</b> ROC curve</a></li>
<li class="chapter" data-level="3.4.3" data-path="introClassifier.html"><a href="introClassifier.html#homework"><i class="fa fa-check"></i><b>3.4.3</b> Homework</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introHypoTest.html"><a href="introHypoTest.html"><i class="fa fa-check"></i><b>4</b> Introduction to Hypothesis testing</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introHypoTest.html"><a href="introHypoTest.html#hypothesis-testing-and-p-value"><i class="fa fa-check"></i><b>4.1</b> Hypothesis testing and <em>p</em> value</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="introHypoTest.html"><a href="introHypoTest.html#example-1-probability-of-rolling-a-six"><i class="fa fa-check"></i><b>4.1.1</b> Example 1: probability of rolling a six?</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="introHypoTest.html"><a href="introHypoTest.html#permutation-test"><i class="fa fa-check"></i><b>4.2</b> Permutation test</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="introHypoTest.html"><a href="introHypoTest.html#example-2-difference-in-birth-weight"><i class="fa fa-check"></i><b>4.2.1</b> Example 2: difference in birth weight</a></li>
<li class="chapter" data-level="4.2.2" data-path="introHypoTest.html"><a href="introHypoTest.html#null-distribution-approximated-by-resampling"><i class="fa fa-check"></i><b>4.2.2</b> Null distribution approximated by resampling</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="introHypoTest.html"><a href="introHypoTest.html#t-test"><i class="fa fa-check"></i><b>4.3</b> <em>t</em> test</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="introHypoTest.html"><a href="introHypoTest.html#derivation-of-t-distribution"><i class="fa fa-check"></i><b>4.3.1</b> Derivation of t distribution</a></li>
<li class="chapter" data-level="4.3.2" data-path="introHypoTest.html"><a href="introHypoTest.html#direct-use-of-t.test"><i class="fa fa-check"></i><b>4.3.2</b> Direct use of <code>t.test()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="introHypoTest.html"><a href="introHypoTest.html#glm-test"><i class="fa fa-check"></i><b>4.4</b> GLM test</a></li>
<li class="chapter" data-level="4.5" data-path="introHypoTest.html"><a href="introHypoTest.html#multiple-testing"><i class="fa fa-check"></i><b>4.5</b> Multiple testing</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="introHypoTest.html"><a href="introHypoTest.html#null-distribution-of-test-statistic"><i class="fa fa-check"></i><b>4.5.1</b> Null distribution (of test statistic)</a></li>
<li class="chapter" data-level="4.5.2" data-path="introHypoTest.html"><a href="introHypoTest.html#null-distribution-of-p-value"><i class="fa fa-check"></i><b>4.5.2</b> Null distribution of p value</a></li>
<li class="chapter" data-level="4.5.3" data-path="introHypoTest.html"><a href="introHypoTest.html#minimal-p-values-in-10-tests"><i class="fa fa-check"></i><b>4.5.3</b> Minimal p values in 10 tests</a></li>
<li class="chapter" data-level="4.5.4" data-path="introHypoTest.html"><a href="introHypoTest.html#homework-1"><i class="fa fa-check"></i><b>4.5.4</b> Homework</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Biomedical Data Modules</b></span></li>
<li class="chapter" data-level="5" data-path="genomics.html"><a href="genomics.html"><i class="fa fa-check"></i><b>5</b> Personalised Genomic Medicine</a>
<ul>
<li class="chapter" data-level="5.1" data-path="genomics.html"><a href="genomics.html#genomics-case1"><i class="fa fa-check"></i><b>5.1</b> Case study 1: splicing fedility prediction</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="genomics.html"><a href="genomics.html#questions-for-discussion"><i class="fa fa-check"></i><b>5.1.1</b> Questions for Discussion</a></li>
<li class="chapter" data-level="5.1.2" data-path="genomics.html"><a href="genomics.html#hands-on-with-regression-model"><i class="fa fa-check"></i><b>5.1.2</b> Hands-on with regression model</a></li>
<li class="chapter" data-level="5.1.3" data-path="genomics.html"><a href="genomics.html#open-question"><i class="fa fa-check"></i><b>5.1.3</b> Open question</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="genomics.html"><a href="genomics.html#genomics-case2"><i class="fa fa-check"></i><b>5.2</b> Case study 2: analysis of cBioportal mutation data</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="genomics.html"><a href="genomics.html#exploratory-analysis"><i class="fa fa-check"></i><b>5.2.1</b> Exploratory analysis</a></li>
<li class="chapter" data-level="5.2.2" data-path="genomics.html"><a href="genomics.html#statistical-analysis"><i class="fa fa-check"></i><b>5.2.2</b> Statistical analysis</a></li>
<li class="chapter" data-level="5.2.3" data-path="genomics.html"><a href="genomics.html#literature-search"><i class="fa fa-check"></i><b>5.2.3</b> Literature search</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="image-digital.html"><a href="image-digital.html"><i class="fa fa-check"></i><b>6</b> Medical Image and Digital Health</a></li>
<li class="chapter" data-level="7" data-path="infectious-dis.html"><a href="infectious-dis.html"><i class="fa fa-check"></i><b>7</b> Infectious Disease Informatics</a></li>
<li class="chapter" data-level="8" data-path="pop-genetics.html"><a href="pop-genetics.html"><i class="fa fa-check"></i><b>8</b> Population Genetics and Diseases</a>
<ul>
<li class="chapter" data-level="8.1" data-path="pop-genetics.html"><a href="pop-genetics.html#case-study-1-heritability-and-human-traits"><i class="fa fa-check"></i><b>8.1</b> Case study 1: Heritability and human traits</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="pop-genetics.html"><a href="pop-genetics.html#part-1"><i class="fa fa-check"></i><b>8.1.1</b> Part 1</a></li>
<li class="chapter" data-level="8.1.2" data-path="pop-genetics.html"><a href="pop-genetics.html#part-2"><i class="fa fa-check"></i><b>8.1.2</b> Part 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="cancer-epidemiology.html"><a href="cancer-epidemiology.html"><i class="fa fa-check"></i><b>9</b> Cancer Epidemiology</a>
<ul>
<li class="chapter" data-level="9.1" data-path="cancer-epidemiology.html"><a href="cancer-epidemiology.html#scenario"><i class="fa fa-check"></i><b>9.1</b> 1. Scenario</a></li>
<li class="chapter" data-level="9.2" data-path="cancer-epidemiology.html"><a href="cancer-epidemiology.html#hong-kong-population"><i class="fa fa-check"></i><b>9.2</b> 2. Hong Kong population</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="cancer-epidemiology.html"><a href="cancer-epidemiology.html#download-population-data"><i class="fa fa-check"></i><b>9.2.1</b> Download population data</a></li>
<li class="chapter" data-level="9.2.2" data-path="cancer-epidemiology.html"><a href="cancer-epidemiology.html#format-data-for-plotting"><i class="fa fa-check"></i><b>9.2.2</b> Format data for plotting</a></li>
<li class="chapter" data-level="9.2.3" data-path="cancer-epidemiology.html"><a href="cancer-epidemiology.html#plotting-population-data"><i class="fa fa-check"></i><b>9.2.3</b> Plotting population data</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="cancer-epidemiology.html"><a href="cancer-epidemiology.html#cancer-registry-data"><i class="fa fa-check"></i><b>9.3</b> 3. Cancer registry data</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="cancer-epidemiology.html"><a href="cancer-epidemiology.html#download-cancer-registry-data"><i class="fa fa-check"></i><b>9.3.1</b> Download cancer registry data</a></li>
<li class="chapter" data-level="9.3.2" data-path="cancer-epidemiology.html"><a href="cancer-epidemiology.html#a.-visualise-changes-in-incidence-and-mortality"><i class="fa fa-check"></i><b>9.3.2</b> 3a. Visualise changes in incidence and mortality</a></li>
<li class="chapter" data-level="9.3.3" data-path="cancer-epidemiology.html"><a href="cancer-epidemiology.html#b.-calculate-cancer-risk-and-mortality-rate"><i class="fa fa-check"></i><b>9.3.3</b> 3b. Calculate cancer risk and mortality rate</a></li>
<li class="chapter" data-level="9.3.4" data-path="cancer-epidemiology.html"><a href="cancer-epidemiology.html#c.-mortality-incidence-ratio"><i class="fa fa-check"></i><b>9.3.4</b> 3c. Mortality-incidence ratio</a></li>
<li class="chapter" data-level="9.3.5" data-path="cancer-epidemiology.html"><a href="cancer-epidemiology.html#d.-paired-t-test-on-mortality-incidence-ratio-change"><i class="fa fa-check"></i><b>9.3.5</b> 3d. Paired t-test on mortality-incidence ratio change</a></li>
<li class="chapter" data-level="9.3.6" data-path="cancer-epidemiology.html"><a href="cancer-epidemiology.html#e.-childhood-versus-elderly-cancers"><i class="fa fa-check"></i><b>9.3.6</b> 3e. Childhood versus elderly cancers</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="cancer-epidemiology.html"><a href="cancer-epidemiology.html#existing-cancer-funding-and-publication-data"><i class="fa fa-check"></i><b>9.4</b> 4. Existing cancer funding and publication data</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="cancer-epidemiology.html"><a href="cancer-epidemiology.html#download-hmrf-grants-and-pubmed-data"><i class="fa fa-check"></i><b>9.4.1</b> Download HMRF grants and Pubmed data</a></li>
<li class="chapter" data-level="9.4.2" data-path="cancer-epidemiology.html"><a href="cancer-epidemiology.html#make-word-cloud-for-grants"><i class="fa fa-check"></i><b>9.4.2</b> Make word cloud for grants</a></li>
<li class="chapter" data-level="9.4.3" data-path="cancer-epidemiology.html"><a href="cancer-epidemiology.html#make-compare-grant-funding-with-incidence-and-mortality"><i class="fa fa-check"></i><b>9.4.3</b> Make compare grant funding with incidence and mortality</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="cancer-epidemiology.html"><a href="cancer-epidemiology.html#task-to-be-completed-in-tutotial-2-by-300pm-and-shared-with-other-tutorial-group"><i class="fa fa-check"></i><b>9.5</b> 5. Task (to be completed in Tutotial 2 by 3:00pm and shared with other tutorial group)</a></li>
</ul></li>
<li class="part"><span><b>III Appendix</b></span></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i>Appendix A: Install R &amp; RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#a.1-install-r"><i class="fa fa-check"></i>A.1 Install R</a>
<ul>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#r-on-windows"><i class="fa fa-check"></i>R on Windows</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#r-on-macos"><i class="fa fa-check"></i>R on macOS</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#r-on-linux-ubuntu"><i class="fa fa-check"></i>R on Linux (Ubuntu)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#a.2-install-rstudio"><i class="fa fa-check"></i>A.2 Install RStudio</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#a.3-use-r-inside-rstudio"><i class="fa fa-check"></i>A.3 Use R inside RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#r-studio"><i class="fa fa-check"></i>R studio</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#set-working-directory"><i class="fa fa-check"></i>Set working directory</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#some-general-knowledge"><i class="fa fa-check"></i>Some general knowledge</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#install-packages-1"><i class="fa fa-check"></i>Install packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#a4.-cloud-computing"><i class="fa fa-check"></i>A4. Cloud computing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Biomedical Data Science - introduction with case studies</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cancer-epidemiology" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Cancer Epidemiology<a href="cancer-epidemiology.html#cancer-epidemiology" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>by Dr Jason Wong</em></p>
<p><em>Date: 16-11-2022 (Updated 21-11-2022)</em></p>
<p><a href="https://github.com/StatBiomed/BMDS-book/raw/main/notebooks/module5-epidemi/M5-epidemiology.Rmd">The RMarkdown notebook to run your own code can be downloaded here</a></p>
<div id="scenario" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> 1. Scenario<a href="cancer-epidemiology.html#scenario" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You are a grants officer working for the Hong Kong Health Bureau. The HK government has recently announced new special funding in cancer research to be administered by the Bureau. You are tasked with coming up with a proposal for distribution of funding to specific cancer types that are in most need of research.</p>
<p><u>Discussion points:</u></p>
<ul>
<li><p>What is important to consider when selecting a cancer type in need of research?</p></li>
<li><p>What type of data is required?</p></li>
</ul>
</div>
<div id="hong-kong-population" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> 2. Hong Kong population<a href="cancer-epidemiology.html#hong-kong-population" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You are aware that generally cancer is disease that affects the elderly more than the young. You decide to first take a closer look at the structure of the population of Hong Kong.</p>
<p><a href="https://www.censtatd.gov.hk/en/web_table.html?id=1A">Historic population of Hong Kong</a> can be obtained from the Census and Statistics Department.</p>
<p>An abridged version of the full historic population of Hong Kong is provided here containing the population of Hong Kong from 1965, 1975, 1985, 1995, 2005, 2015 and 2022 categorised by sex and age (0-19, 20-44, 45-64, 65+).</p>
<p><u>Discussion points:</u></p>
<ul>
<li><p>What is the trend in Hong Kong’s population over the past ~60 years?</p></li>
<li><p>What is the best way to visualise this data?</p></li>
</ul>
<div id="download-population-data" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Download population data<a href="cancer-epidemiology.html#download-population-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="cancer-epidemiology.html#cb165-1" tabindex="-1"></a>HKPop<span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://github.com/StatBiomed/BMDS-book/raw/main/notebooks/module5-epidemi/HK_population_1965-2022.txt&quot;</span>, </span>
<span id="cb165-2"><a href="cancer-epidemiology.html#cb165-2" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactor=</span><span class="cn">FALSE</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb165-3"><a href="cancer-epidemiology.html#cb165-3" tabindex="-1"></a>HKPop</span>
<span id="cb165-4"><a href="cancer-epidemiology.html#cb165-4" tabindex="-1"></a><span class="co">#&gt;      Sex   Age  1965  1975   1985   1995   2005   2015   2022</span></span>
<span id="cb165-5"><a href="cancer-epidemiology.html#cb165-5" tabindex="-1"></a><span class="co">#&gt; 1   male  0-19 901.9 989.7  909.0  835.6  719.0  613.8  530.6</span></span>
<span id="cb165-6"><a href="cancer-epidemiology.html#cb165-6" tabindex="-1"></a><span class="co">#&gt; 2   male 20-44 607.4 795.6 1210.2 1363.7 1263.7 1146.9 1039.2</span></span>
<span id="cb165-7"><a href="cancer-epidemiology.html#cb165-7" tabindex="-1"></a><span class="co">#&gt; 3   male 45-64 266.5 414.3  525.9  615.7  896.6 1084.9 1046.2</span></span>
<span id="cb165-8"><a href="cancer-epidemiology.html#cb165-8" tabindex="-1"></a><span class="co">#&gt; 4   male   65+  42.2  84.6  170.5  269.3  384.7  520.0  713.6</span></span>
<span id="cb165-9"><a href="cancer-epidemiology.html#cb165-9" tabindex="-1"></a><span class="co">#&gt; 5 female  0-19 865.6 938.8  840.3  780.7  684.1  575.0  502.1</span></span>
<span id="cb165-10"><a href="cancer-epidemiology.html#cb165-10" tabindex="-1"></a><span class="co">#&gt; 6 female 20-44 539.3 685.6 1093.7 1423.6 1530.4 1531.8 1338.7</span></span>
<span id="cb165-11"><a href="cancer-epidemiology.html#cb165-11" tabindex="-1"></a><span class="co">#&gt; 7 female 45-64 286.3 400.7  470.7  535.0  884.7 1224.3 1314.7</span></span>
<span id="cb165-12"><a href="cancer-epidemiology.html#cb165-12" tabindex="-1"></a><span class="co">#&gt; 8 female   65+  88.7 152.3  235.9  332.5  450.0  594.6  806.5</span></span></code></pre></div>
</div>
<div id="format-data-for-plotting" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Format data for plotting<a href="cancer-epidemiology.html#format-data-for-plotting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here we convert the original dataframe into simplified format for ggplot2.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="cancer-epidemiology.html#cb166-1" tabindex="-1"></a></span>
<span id="cb166-2"><a href="cancer-epidemiology.html#cb166-2" tabindex="-1"></a>male<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">as.numeric</span>(<span class="fu">colnames</span>(HKPop[<span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>])),</span>
<span id="cb166-3"><a href="cancer-epidemiology.html#cb166-3" tabindex="-1"></a>                 <span class="st">`</span><span class="at">0-19</span><span class="st">`</span>  <span class="ot">=</span> <span class="fu">as.numeric</span>(HKPop[<span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>]),</span>
<span id="cb166-4"><a href="cancer-epidemiology.html#cb166-4" tabindex="-1"></a>                 <span class="st">`</span><span class="at">20-44</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(HKPop[<span class="dv">2</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>]),</span>
<span id="cb166-5"><a href="cancer-epidemiology.html#cb166-5" tabindex="-1"></a>                 <span class="st">`</span><span class="at">45-64</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(HKPop[<span class="dv">3</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>]),</span>
<span id="cb166-6"><a href="cancer-epidemiology.html#cb166-6" tabindex="-1"></a>                 <span class="st">`</span><span class="at">65+</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(HKPop[<span class="dv">4</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>]),</span>
<span id="cb166-7"><a href="cancer-epidemiology.html#cb166-7" tabindex="-1"></a>                 <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb166-8"><a href="cancer-epidemiology.html#cb166-8" tabindex="-1"></a></span>
<span id="cb166-9"><a href="cancer-epidemiology.html#cb166-9" tabindex="-1"></a></span>
<span id="cb166-10"><a href="cancer-epidemiology.html#cb166-10" tabindex="-1"></a></span>
<span id="cb166-11"><a href="cancer-epidemiology.html#cb166-11" tabindex="-1"></a>female<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">as.numeric</span>(<span class="fu">colnames</span>(HKPop[<span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>])),</span>
<span id="cb166-12"><a href="cancer-epidemiology.html#cb166-12" tabindex="-1"></a>                 <span class="st">`</span><span class="at">0-19</span><span class="st">`</span>  <span class="ot">=</span> <span class="fu">as.numeric</span>(HKPop[<span class="dv">5</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>]),</span>
<span id="cb166-13"><a href="cancer-epidemiology.html#cb166-13" tabindex="-1"></a>                 <span class="st">`</span><span class="at">20-44</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(HKPop[<span class="dv">6</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>]),</span>
<span id="cb166-14"><a href="cancer-epidemiology.html#cb166-14" tabindex="-1"></a>                 <span class="st">`</span><span class="at">45-64</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(HKPop[<span class="dv">7</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>]),</span>
<span id="cb166-15"><a href="cancer-epidemiology.html#cb166-15" tabindex="-1"></a>                 <span class="st">`</span><span class="at">65+</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(HKPop[<span class="dv">8</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>]),</span>
<span id="cb166-16"><a href="cancer-epidemiology.html#cb166-16" tabindex="-1"></a>                 <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb166-17"><a href="cancer-epidemiology.html#cb166-17" tabindex="-1"></a></span>
<span id="cb166-18"><a href="cancer-epidemiology.html#cb166-18" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;tidyverse&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb166-19"><a href="cancer-epidemiology.html#cb166-19" tabindex="-1"></a>male<span class="ot">&lt;-</span><span class="fu">as_tibble</span>(male) <span class="sc">%&gt;%</span> <span class="fu">select</span>(year,<span class="st">`</span><span class="at">0-19</span><span class="st">`</span>,<span class="st">`</span><span class="at">20-44</span><span class="st">`</span>,<span class="st">`</span><span class="at">45-64</span><span class="st">`</span>,<span class="st">`</span><span class="at">65+</span><span class="st">`</span>) <span class="sc">%&gt;%</span> <span class="fu">gather</span> (<span class="at">key=</span><span class="st">&quot;age&quot;</span>,<span class="at">value=</span><span class="st">&quot;population (&#39;000s)&quot;</span>,<span class="sc">-</span>year)</span>
<span id="cb166-20"><a href="cancer-epidemiology.html#cb166-20" tabindex="-1"></a>female<span class="ot">&lt;-</span><span class="fu">as_tibble</span>(female) <span class="sc">%&gt;%</span> <span class="fu">select</span>(year,<span class="st">`</span><span class="at">0-19</span><span class="st">`</span>,<span class="st">`</span><span class="at">20-44</span><span class="st">`</span>,<span class="st">`</span><span class="at">45-64</span><span class="st">`</span>,<span class="st">`</span><span class="at">65+</span><span class="st">`</span>) <span class="sc">%&gt;%</span> <span class="fu">gather</span> (<span class="at">key=</span><span class="st">&quot;age&quot;</span>,<span class="at">value=</span><span class="st">&quot;population (&#39;000s)&quot;</span>,<span class="sc">-</span>year)</span>
<span id="cb166-21"><a href="cancer-epidemiology.html#cb166-21" tabindex="-1"></a>male</span>
<span id="cb166-22"><a href="cancer-epidemiology.html#cb166-22" tabindex="-1"></a><span class="co">#&gt; # A tibble: 28 × 3</span></span>
<span id="cb166-23"><a href="cancer-epidemiology.html#cb166-23" tabindex="-1"></a><span class="co">#&gt;     year age   `population (&#39;000s)`</span></span>
<span id="cb166-24"><a href="cancer-epidemiology.html#cb166-24" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt; &lt;chr&gt;                &lt;dbl&gt;</span></span>
<span id="cb166-25"><a href="cancer-epidemiology.html#cb166-25" tabindex="-1"></a><span class="co">#&gt;  1  1965 0-19                  902.</span></span>
<span id="cb166-26"><a href="cancer-epidemiology.html#cb166-26" tabindex="-1"></a><span class="co">#&gt;  2  1975 0-19                  990.</span></span>
<span id="cb166-27"><a href="cancer-epidemiology.html#cb166-27" tabindex="-1"></a><span class="co">#&gt;  3  1985 0-19                  909 </span></span>
<span id="cb166-28"><a href="cancer-epidemiology.html#cb166-28" tabindex="-1"></a><span class="co">#&gt;  4  1995 0-19                  836.</span></span>
<span id="cb166-29"><a href="cancer-epidemiology.html#cb166-29" tabindex="-1"></a><span class="co">#&gt;  5  2005 0-19                  719 </span></span>
<span id="cb166-30"><a href="cancer-epidemiology.html#cb166-30" tabindex="-1"></a><span class="co">#&gt;  6  2015 0-19                  614.</span></span>
<span id="cb166-31"><a href="cancer-epidemiology.html#cb166-31" tabindex="-1"></a><span class="co">#&gt;  7  2022 0-19                  531.</span></span>
<span id="cb166-32"><a href="cancer-epidemiology.html#cb166-32" tabindex="-1"></a><span class="co">#&gt;  8  1965 20-44                 607.</span></span>
<span id="cb166-33"><a href="cancer-epidemiology.html#cb166-33" tabindex="-1"></a><span class="co">#&gt;  9  1975 20-44                 796.</span></span>
<span id="cb166-34"><a href="cancer-epidemiology.html#cb166-34" tabindex="-1"></a><span class="co">#&gt; 10  1985 20-44                1210.</span></span>
<span id="cb166-35"><a href="cancer-epidemiology.html#cb166-35" tabindex="-1"></a><span class="co">#&gt; # ℹ 18 more rows</span></span>
<span id="cb166-36"><a href="cancer-epidemiology.html#cb166-36" tabindex="-1"></a>female</span>
<span id="cb166-37"><a href="cancer-epidemiology.html#cb166-37" tabindex="-1"></a><span class="co">#&gt; # A tibble: 28 × 3</span></span>
<span id="cb166-38"><a href="cancer-epidemiology.html#cb166-38" tabindex="-1"></a><span class="co">#&gt;     year age   `population (&#39;000s)`</span></span>
<span id="cb166-39"><a href="cancer-epidemiology.html#cb166-39" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt; &lt;chr&gt;                &lt;dbl&gt;</span></span>
<span id="cb166-40"><a href="cancer-epidemiology.html#cb166-40" tabindex="-1"></a><span class="co">#&gt;  1  1965 0-19                  866.</span></span>
<span id="cb166-41"><a href="cancer-epidemiology.html#cb166-41" tabindex="-1"></a><span class="co">#&gt;  2  1975 0-19                  939.</span></span>
<span id="cb166-42"><a href="cancer-epidemiology.html#cb166-42" tabindex="-1"></a><span class="co">#&gt;  3  1985 0-19                  840.</span></span>
<span id="cb166-43"><a href="cancer-epidemiology.html#cb166-43" tabindex="-1"></a><span class="co">#&gt;  4  1995 0-19                  781.</span></span>
<span id="cb166-44"><a href="cancer-epidemiology.html#cb166-44" tabindex="-1"></a><span class="co">#&gt;  5  2005 0-19                  684.</span></span>
<span id="cb166-45"><a href="cancer-epidemiology.html#cb166-45" tabindex="-1"></a><span class="co">#&gt;  6  2015 0-19                  575 </span></span>
<span id="cb166-46"><a href="cancer-epidemiology.html#cb166-46" tabindex="-1"></a><span class="co">#&gt;  7  2022 0-19                  502.</span></span>
<span id="cb166-47"><a href="cancer-epidemiology.html#cb166-47" tabindex="-1"></a><span class="co">#&gt;  8  1965 20-44                 539.</span></span>
<span id="cb166-48"><a href="cancer-epidemiology.html#cb166-48" tabindex="-1"></a><span class="co">#&gt;  9  1975 20-44                 686.</span></span>
<span id="cb166-49"><a href="cancer-epidemiology.html#cb166-49" tabindex="-1"></a><span class="co">#&gt; 10  1985 20-44                1094.</span></span>
<span id="cb166-50"><a href="cancer-epidemiology.html#cb166-50" tabindex="-1"></a><span class="co">#&gt; # ℹ 18 more rows</span></span></code></pre></div>
</div>
<div id="plotting-population-data" class="section level3 hasAnchor" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> Plotting population data<a href="cancer-epidemiology.html#plotting-population-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Uses ggplot2 and gridExtra to make line plot of male and female population data side-by-side.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="cancer-epidemiology.html#cb167-1" tabindex="-1"></a></span>
<span id="cb167-2"><a href="cancer-epidemiology.html#cb167-2" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;ggplot2&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;gglot2&quot;</span>)</span>
<span id="cb167-3"><a href="cancer-epidemiology.html#cb167-3" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;gridExtra&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;gridExtra&quot;</span>)</span>
<span id="cb167-4"><a href="cancer-epidemiology.html#cb167-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb167-5"><a href="cancer-epidemiology.html#cb167-5" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb167-6"><a href="cancer-epidemiology.html#cb167-6" tabindex="-1"></a><span class="co">#Import the necessary packages and libraries</span></span>
<span id="cb167-7"><a href="cancer-epidemiology.html#cb167-7" tabindex="-1"></a>pmale<span class="ot">&lt;-</span><span class="fu">ggplot</span>(male,<span class="fu">aes</span>(<span class="at">x=</span>year,<span class="at">y=</span><span class="st">`</span><span class="at">population (&#39;000s)</span><span class="st">`</span>,<span class="at">group=</span>age))<span class="sc">+</span></span>
<span id="cb167-8"><a href="cancer-epidemiology.html#cb167-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>age))<span class="sc">+</span></span>
<span id="cb167-9"><a href="cancer-epidemiology.html#cb167-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>age))<span class="sc">+</span></span>
<span id="cb167-10"><a href="cancer-epidemiology.html#cb167-10" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Spectral&quot;</span>)<span class="sc">+</span></span>
<span id="cb167-11"><a href="cancer-epidemiology.html#cb167-11" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb167-12"><a href="cancer-epidemiology.html#cb167-12" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1600</span>)<span class="sc">+</span></span>
<span id="cb167-13"><a href="cancer-epidemiology.html#cb167-13" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb167-14"><a href="cancer-epidemiology.html#cb167-14" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1965</span>, <span class="dv">2022</span>, <span class="at">by =</span> <span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb167-15"><a href="cancer-epidemiology.html#cb167-15" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;male&quot;</span>)</span>
<span id="cb167-16"><a href="cancer-epidemiology.html#cb167-16" tabindex="-1"></a>pfemale<span class="ot">&lt;-</span><span class="fu">ggplot</span>(female,<span class="fu">aes</span>(<span class="at">x=</span>year,<span class="at">y=</span><span class="st">`</span><span class="at">population (&#39;000s)</span><span class="st">`</span>,<span class="at">group=</span>age))<span class="sc">+</span></span>
<span id="cb167-17"><a href="cancer-epidemiology.html#cb167-17" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>age))<span class="sc">+</span></span>
<span id="cb167-18"><a href="cancer-epidemiology.html#cb167-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>age))<span class="sc">+</span></span>
<span id="cb167-19"><a href="cancer-epidemiology.html#cb167-19" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Spectral&quot;</span>)<span class="sc">+</span></span>
<span id="cb167-20"><a href="cancer-epidemiology.html#cb167-20" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb167-21"><a href="cancer-epidemiology.html#cb167-21" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1600</span>)<span class="sc">+</span></span>
<span id="cb167-22"><a href="cancer-epidemiology.html#cb167-22" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;right&quot;</span>,<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb167-23"><a href="cancer-epidemiology.html#cb167-23" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1965</span>, <span class="dv">2022</span>, <span class="at">by =</span> <span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb167-24"><a href="cancer-epidemiology.html#cb167-24" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;female&quot;</span>)</span>
<span id="cb167-25"><a href="cancer-epidemiology.html#cb167-25" tabindex="-1"></a><span class="fu">grid.arrange</span>(pmale,pfemale,<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">widths=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="fl">3.75</span>))</span></code></pre></div>
<p><img src="BMDatSci_files/figure-html/plot%20data-1.png" width="672" /></p>
</div>
</div>
<div id="cancer-registry-data" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> 3. Cancer registry data<a href="cancer-epidemiology.html#cancer-registry-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It is clear that Hong Kong has an aging population, thus cancer incidence would also likely increase. To examine cancer incidence and mortality in Hong Kong you obtain data from the <a href="https://www3.ha.org.hk/cancereg/">Hong Kong Cancer Registry</a>, which is maintained by the Hospital Authority.</p>
<p>Cancer incidence data was summarised for the last three decades (1990-1999, 2000-2009 and 2010-2019).</p>
<p><u>Discussion points:</u></p>
<ul>
<li><p>Has incidence been increasing for most cancers? How about mortality?</p></li>
<li><p>How has cancer risk and mortality rate changed in the past 3 decades?</p></li>
<li><p>Has the incidence-to-mortality ratio been decreasing generally? Is it statistically significant?</p></li>
<li><p>Which cancer type has the highest incidence in children (0-19) when compared with the elderly (65+). Is this statistically significantly different to incidence of children versus elderly cancers in general?</p></li>
</ul>
<div id="download-cancer-registry-data" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Download cancer registry data<a href="cancer-epidemiology.html#download-cancer-registry-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="cancer-epidemiology.html#cb168-1" tabindex="-1"></a>HKCancer<span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://github.com/StatBiomed/BMDS-book/raw/main/notebooks/module5-epidemi/HK_cancer_incidence_mortality_1990-2020.txt&quot;</span>,</span>
<span id="cb168-2"><a href="cancer-epidemiology.html#cb168-2" tabindex="-1"></a>                      <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactor=</span><span class="cn">FALSE</span>)</span>
<span id="cb168-3"><a href="cancer-epidemiology.html#cb168-3" tabindex="-1"></a>HKCancer</span>
<span id="cb168-4"><a href="cancer-epidemiology.html#cb168-4" tabindex="-1"></a><span class="co">#&gt;         Type    Sex   Age      Year Biliary Bladder Brain Breast Cervix</span></span>
<span id="cb168-5"><a href="cancer-epidemiology.html#cb168-5" tabindex="-1"></a><span class="co">#&gt; 1  incidence   male  0-19 1990-1999       0       6   212      0      0</span></span>
<span id="cb168-6"><a href="cancer-epidemiology.html#cb168-6" tabindex="-1"></a><span class="co">#&gt; 2  incidence   male 20-44 1990-1999      36     165   368      6      0</span></span>
<span id="cb168-7"><a href="cancer-epidemiology.html#cb168-7" tabindex="-1"></a><span class="co">#&gt; 3  incidence   male 45-64 1990-1999     322    1266   393     28      0</span></span>
<span id="cb168-8"><a href="cancer-epidemiology.html#cb168-8" tabindex="-1"></a><span class="co">#&gt; 4  incidence   male   65+ 1990-1999     830    2920   318     35      0</span></span>
<span id="cb168-9"><a href="cancer-epidemiology.html#cb168-9" tabindex="-1"></a><span class="co">#&gt; 5  incidence   male  0-19 2000-2009       0       2   206      0      0</span></span>
<span id="cb168-10"><a href="cancer-epidemiology.html#cb168-10" tabindex="-1"></a><span class="co">#&gt; 6  incidence   male 20-44 2000-2009      31     103   267      9      0</span></span>
<span id="cb168-11"><a href="cancer-epidemiology.html#cb168-11" tabindex="-1"></a><span class="co">#&gt; 7  incidence   male 45-64 2000-2009     297     900   372     52      0</span></span>
<span id="cb168-12"><a href="cancer-epidemiology.html#cb168-12" tabindex="-1"></a><span class="co">#&gt; 8  incidence   male   65+ 2000-2009    1134    3103   299     96      0</span></span>
<span id="cb168-13"><a href="cancer-epidemiology.html#cb168-13" tabindex="-1"></a><span class="co">#&gt; 9  incidence   male  0-19 2010-2019       0       2   155      0      0</span></span>
<span id="cb168-14"><a href="cancer-epidemiology.html#cb168-14" tabindex="-1"></a><span class="co">#&gt; 10 incidence   male 20-44 2010-2019      28      18   276     14      0</span></span>
<span id="cb168-15"><a href="cancer-epidemiology.html#cb168-15" tabindex="-1"></a><span class="co">#&gt; 11 incidence   male 45-64 2010-2019     530     648   511     72      0</span></span>
<span id="cb168-16"><a href="cancer-epidemiology.html#cb168-16" tabindex="-1"></a><span class="co">#&gt; 12 incidence   male   65+ 2010-2019    1568    2399   380    107      0</span></span>
<span id="cb168-17"><a href="cancer-epidemiology.html#cb168-17" tabindex="-1"></a><span class="co">#&gt; 13 incidence female  0-19 1990-1999       0       2   149      6      0</span></span>
<span id="cb168-18"><a href="cancer-epidemiology.html#cb168-18" tabindex="-1"></a><span class="co">#&gt; 14 incidence female 20-44 1990-1999      52      62   283   4228   1263</span></span>
<span id="cb168-19"><a href="cancer-epidemiology.html#cb168-19" tabindex="-1"></a><span class="co">#&gt; 15 incidence female 45-64 1990-1999     246     246   238   5311   1839</span></span>
<span id="cb168-20"><a href="cancer-epidemiology.html#cb168-20" tabindex="-1"></a><span class="co">#&gt; 16 incidence female   65+ 1990-1999     909    1199   284   4122   1574</span></span>
<span id="cb168-21"><a href="cancer-epidemiology.html#cb168-21" tabindex="-1"></a><span class="co">#&gt; 17 incidence female  0-19 2000-2009       0       0   132      4      4</span></span>
<span id="cb168-22"><a href="cancer-epidemiology.html#cb168-22" tabindex="-1"></a><span class="co">#&gt; 18 incidence female 20-44 2000-2009      34      39   223   5887   1204</span></span>
<span id="cb168-23"><a href="cancer-epidemiology.html#cb168-23" tabindex="-1"></a><span class="co">#&gt; 19 incidence female 45-64 2000-2009     287     179   265  11833   1676</span></span>
<span id="cb168-24"><a href="cancer-epidemiology.html#cb168-24" tabindex="-1"></a><span class="co">#&gt; 20 incidence female   65+ 2000-2009    1190    1090   237   5774   1329</span></span>
<span id="cb168-25"><a href="cancer-epidemiology.html#cb168-25" tabindex="-1"></a><span class="co">#&gt; 21 incidence female  0-19 2010-2019       0       2   119      1      0</span></span>
<span id="cb168-26"><a href="cancer-epidemiology.html#cb168-26" tabindex="-1"></a><span class="co">#&gt; 22 incidence female 20-44 2010-2019      36      17   223   6658   1294</span></span>
<span id="cb168-27"><a href="cancer-epidemiology.html#cb168-27" tabindex="-1"></a><span class="co">#&gt; 23 incidence female 45-64 2010-2019     452     188   394  22096   2288</span></span>
<span id="cb168-28"><a href="cancer-epidemiology.html#cb168-28" tabindex="-1"></a><span class="co">#&gt; 24 incidence female   65+ 2010-2019    1500     872   283  10337   1269</span></span>
<span id="cb168-29"><a href="cancer-epidemiology.html#cb168-29" tabindex="-1"></a><span class="co">#&gt; 25 mortality   male  0-19 1990-1999       0       0    76      0      0</span></span>
<span id="cb168-30"><a href="cancer-epidemiology.html#cb168-30" tabindex="-1"></a><span class="co">#&gt;    Colorectum Eye Hodgkin.lymphoma Kaposi Kidney Larynx Leukaemia Liver  Lung</span></span>
<span id="cb168-31"><a href="cancer-epidemiology.html#cb168-31" tabindex="-1"></a><span class="co">#&gt; 1          15  29               35      0     24      1       356    58     6</span></span>
<span id="cb168-32"><a href="cancer-epidemiology.html#cb168-32" tabindex="-1"></a><span class="co">#&gt; 2        1087   8               64      0    141     86       509  1741  1036</span></span>
<span id="cb168-33"><a href="cancer-epidemiology.html#cb168-33" tabindex="-1"></a><span class="co">#&gt; 3        4644   9               47      0    530    824       453  5702  8420</span></span>
<span id="cb168-34"><a href="cancer-epidemiology.html#cb168-34" tabindex="-1"></a><span class="co">#&gt; 4        8058  21               41      0    721   1265       623  4806 15152</span></span>
<span id="cb168-35"><a href="cancer-epidemiology.html#cb168-35" tabindex="-1"></a><span class="co">#&gt; 5           5  38               32      0     20      0       329    33     3</span></span>
<span id="cb168-36"><a href="cancer-epidemiology.html#cb168-36" tabindex="-1"></a><span class="co">#&gt; 6         957   8              119      9    221     37       437  1116   772</span></span>
<span id="cb168-37"><a href="cancer-epidemiology.html#cb168-37" tabindex="-1"></a><span class="co">#&gt; 7        6418  18               77      4   1071    658       642  6015  7909</span></span>
<span id="cb168-38"><a href="cancer-epidemiology.html#cb168-38" tabindex="-1"></a><span class="co">#&gt; 8       13352  13               77      8   1275   1125       864  5808 18870</span></span>
<span id="cb168-39"><a href="cancer-epidemiology.html#cb168-39" tabindex="-1"></a><span class="co">#&gt; 9           6  26               53      0     31      0       338    24     2</span></span>
<span id="cb168-40"><a href="cancer-epidemiology.html#cb168-40" tabindex="-1"></a><span class="co">#&gt; 10       1005  10              163     25    293     29       401   659   541</span></span>
<span id="cb168-41"><a href="cancer-epidemiology.html#cb168-41" tabindex="-1"></a><span class="co">#&gt; 11      10034  28               87     18   1978    684      1033  6500  9523</span></span>
<span id="cb168-42"><a href="cancer-epidemiology.html#cb168-42" tabindex="-1"></a><span class="co">#&gt; 12      18003  15              114     12   1977   1043      1381  6716 20588</span></span>
<span id="cb168-43"><a href="cancer-epidemiology.html#cb168-43" tabindex="-1"></a><span class="co">#&gt; 13          2  33               10      0     25      0       296    37     7</span></span>
<span id="cb168-44"><a href="cancer-epidemiology.html#cb168-44" tabindex="-1"></a><span class="co">#&gt; 14        932  11               61      0     98     13       393   353   597</span></span>
<span id="cb168-45"><a href="cancer-epidemiology.html#cb168-45" tabindex="-1"></a><span class="co">#&gt; 15       3166   9               19      0    256     59       312  1093  2629</span></span>
<span id="cb168-46"><a href="cancer-epidemiology.html#cb168-46" tabindex="-1"></a><span class="co">#&gt; 16       7728  16               33      0    503    130       534  2244  8428</span></span>
<span id="cb168-47"><a href="cancer-epidemiology.html#cb168-47" tabindex="-1"></a><span class="co">#&gt; 17          5  14               30      0     15      0       219    13     5</span></span>
<span id="cb168-48"><a href="cancer-epidemiology.html#cb168-48" tabindex="-1"></a><span class="co">#&gt; 18        938  12              122      2    120      5       405   212   625</span></span>
<span id="cb168-49"><a href="cancer-epidemiology.html#cb168-49" tabindex="-1"></a><span class="co">#&gt; 19       4430  10               33      0    482     37       469  1041  3397</span></span>
<span id="cb168-50"><a href="cancer-epidemiology.html#cb168-50" tabindex="-1"></a><span class="co">#&gt; 20      10810   8               35      0    830     85       723  2637  9517</span></span>
<span id="cb168-51"><a href="cancer-epidemiology.html#cb168-51" tabindex="-1"></a><span class="co">#&gt; 21          5  14               32      0     19      0       237    21     0</span></span>
<span id="cb168-52"><a href="cancer-epidemiology.html#cb168-52" tabindex="-1"></a><span class="co">#&gt; 22       1057   9              174      0    135      7       443   168   647</span></span>
<span id="cb168-53"><a href="cancer-epidemiology.html#cb168-53" tabindex="-1"></a><span class="co">#&gt; 23       7200  16               58      4    887     47       786  1168  6312</span></span>
<span id="cb168-54"><a href="cancer-epidemiology.html#cb168-54" tabindex="-1"></a><span class="co">#&gt; 24      13119  20               58      5   1203     84       913  3007 10872</span></span>
<span id="cb168-55"><a href="cancer-epidemiology.html#cb168-55" tabindex="-1"></a><span class="co">#&gt; 25         10   3                0      0      2      0       120    36     1</span></span>
<span id="cb168-56"><a href="cancer-epidemiology.html#cb168-56" tabindex="-1"></a><span class="co">#&gt;    Melanoma Mesothelioma Multiple.myeloma Nasal Nasopharynx</span></span>
<span id="cb168-57"><a href="cancer-epidemiology.html#cb168-57" tabindex="-1"></a><span class="co">#&gt; 1         3            0                1     4          33</span></span>
<span id="cb168-58"><a href="cancer-epidemiology.html#cb168-58" tabindex="-1"></a><span class="co">#&gt; 2        50            0               43    53        3049</span></span>
<span id="cb168-59"><a href="cancer-epidemiology.html#cb168-59" tabindex="-1"></a><span class="co">#&gt; 3        82            0              210   109        3724</span></span>
<span id="cb168-60"><a href="cancer-epidemiology.html#cb168-60" tabindex="-1"></a><span class="co">#&gt; 4       107            0              421   120        1212</span></span>
<span id="cb168-61"><a href="cancer-epidemiology.html#cb168-61" tabindex="-1"></a><span class="co">#&gt; 5         1            0                1     7          16</span></span>
<span id="cb168-62"><a href="cancer-epidemiology.html#cb168-62" tabindex="-1"></a><span class="co">#&gt; 6        41            5               38    38        2114</span></span>
<span id="cb168-63"><a href="cancer-epidemiology.html#cb168-63" tabindex="-1"></a><span class="co">#&gt; 7        98           34              326   161        3750</span></span>
<span id="cb168-64"><a href="cancer-epidemiology.html#cb168-64" tabindex="-1"></a><span class="co">#&gt; 8       137           77              674   137        1177</span></span>
<span id="cb168-65"><a href="cancer-epidemiology.html#cb168-65" tabindex="-1"></a><span class="co">#&gt; 9         0            0                0     3          21</span></span>
<span id="cb168-66"><a href="cancer-epidemiology.html#cb168-66" tabindex="-1"></a><span class="co">#&gt; 10       47            4               26    41        1339</span></span>
<span id="cb168-67"><a href="cancer-epidemiology.html#cb168-67" tabindex="-1"></a><span class="co">#&gt; 11      186           51              525   174        3653</span></span>
<span id="cb168-68"><a href="cancer-epidemiology.html#cb168-68" tabindex="-1"></a><span class="co">#&gt; 12      195          154              910   154        1207</span></span>
<span id="cb168-69"><a href="cancer-epidemiology.html#cb168-69" tabindex="-1"></a><span class="co">#&gt; 13        2            0                1     1          13</span></span>
<span id="cb168-70"><a href="cancer-epidemiology.html#cb168-70" tabindex="-1"></a><span class="co">#&gt; 14       44            0               19    31        1380</span></span>
<span id="cb168-71"><a href="cancer-epidemiology.html#cb168-71" tabindex="-1"></a><span class="co">#&gt; 15       58            0              150    57        1157</span></span>
<span id="cb168-72"><a href="cancer-epidemiology.html#cb168-72" tabindex="-1"></a><span class="co">#&gt; 16      102            0              417    93         536</span></span>
<span id="cb168-73"><a href="cancer-epidemiology.html#cb168-73" tabindex="-1"></a><span class="co">#&gt; 17        2            0                0     5           6</span></span>
<span id="cb168-74"><a href="cancer-epidemiology.html#cb168-74" tabindex="-1"></a><span class="co">#&gt; 18       41            8               21    36         942</span></span>
<span id="cb168-75"><a href="cancer-epidemiology.html#cb168-75" tabindex="-1"></a><span class="co">#&gt; 19      102           12              185    74        1187</span></span>
<span id="cb168-76"><a href="cancer-epidemiology.html#cb168-76" tabindex="-1"></a><span class="co">#&gt; 20      118           14              559    92         465</span></span>
<span id="cb168-77"><a href="cancer-epidemiology.html#cb168-77" tabindex="-1"></a><span class="co">#&gt; 21        3            0                0     6           6</span></span>
<span id="cb168-78"><a href="cancer-epidemiology.html#cb168-78" tabindex="-1"></a><span class="co">#&gt; 22       70           10               24    37         583</span></span>
<span id="cb168-79"><a href="cancer-epidemiology.html#cb168-79" tabindex="-1"></a><span class="co">#&gt; 23      128           34              399   105        1145</span></span>
<span id="cb168-80"><a href="cancer-epidemiology.html#cb168-80" tabindex="-1"></a><span class="co">#&gt; 24      179           24              636   102         389</span></span>
<span id="cb168-81"><a href="cancer-epidemiology.html#cb168-81" tabindex="-1"></a><span class="co">#&gt; 25        2            0                0     0           6</span></span>
<span id="cb168-82"><a href="cancer-epidemiology.html#cb168-82" tabindex="-1"></a><span class="co">#&gt;    Non.Hodgkin.lymphoma Non.melanoma.skin Oesophagus Oral Ovary Pancreas Penis</span></span>
<span id="cb168-83"><a href="cancer-epidemiology.html#cb168-83" tabindex="-1"></a><span class="co">#&gt; 1                   137                 8          0   18     0        4     2</span></span>
<span id="cb168-84"><a href="cancer-epidemiology.html#cb168-84" tabindex="-1"></a><span class="co">#&gt; 2                   596               211        158  324     0      106    19</span></span>
<span id="cb168-85"><a href="cancer-epidemiology.html#cb168-85" tabindex="-1"></a><span class="co">#&gt; 3                   997               613       1873 1165     0      514    78</span></span>
<span id="cb168-86"><a href="cancer-epidemiology.html#cb168-86" tabindex="-1"></a><span class="co">#&gt; 4                  1210               968       2203 1055     0      887   184</span></span>
<span id="cb168-87"><a href="cancer-epidemiology.html#cb168-87" tabindex="-1"></a><span class="co">#&gt; 5                   111                 4          0    6     0        1     0</span></span>
<span id="cb168-88"><a href="cancer-epidemiology.html#cb168-88" tabindex="-1"></a><span class="co">#&gt; 6                   454               220         82  312     0       71    18</span></span>
<span id="cb168-89"><a href="cancer-epidemiology.html#cb168-89" tabindex="-1"></a><span class="co">#&gt; 7                  1216               917       1528 1354     0      780    71</span></span>
<span id="cb168-90"><a href="cancer-epidemiology.html#cb168-90" tabindex="-1"></a><span class="co">#&gt; 8                  1756              1835       2126 1416     0     1440   199</span></span>
<span id="cb168-91"><a href="cancer-epidemiology.html#cb168-91" tabindex="-1"></a><span class="co">#&gt; 9                   106                 1          0    9     0        1     0</span></span>
<span id="cb168-92"><a href="cancer-epidemiology.html#cb168-92" tabindex="-1"></a><span class="co">#&gt; 10                  487               291         54  304     0      109    21</span></span>
<span id="cb168-93"><a href="cancer-epidemiology.html#cb168-93" tabindex="-1"></a><span class="co">#&gt; 11                 1910              1782       1321 1941     0     1402   154</span></span>
<span id="cb168-94"><a href="cancer-epidemiology.html#cb168-94" tabindex="-1"></a><span class="co">#&gt; 12                 2633              2975       1982 1813     0     2302   279</span></span>
<span id="cb168-95"><a href="cancer-epidemiology.html#cb168-95" tabindex="-1"></a><span class="co">#&gt; 13                   75                 2          0   21    77        2     0</span></span>
<span id="cb168-96"><a href="cancer-epidemiology.html#cb168-96" tabindex="-1"></a><span class="co">#&gt; 14                  444               156         48  241   854       60     0</span></span>
<span id="cb168-97"><a href="cancer-epidemiology.html#cb168-97" tabindex="-1"></a><span class="co">#&gt; 15                  594               374        254  364   970      290     0</span></span>
<span id="cb168-98"><a href="cancer-epidemiology.html#cb168-98" tabindex="-1"></a><span class="co">#&gt; 16                 1120              1249        761  485   776      875     0</span></span>
<span id="cb168-99"><a href="cancer-epidemiology.html#cb168-99" tabindex="-1"></a><span class="co">#&gt; 17                   43                 4          1   20   108        0     0</span></span>
<span id="cb168-100"><a href="cancer-epidemiology.html#cb168-100" tabindex="-1"></a><span class="co">#&gt; 18                  461               182         13  254  1299       62     0</span></span>
<span id="cb168-101"><a href="cancer-epidemiology.html#cb168-101" tabindex="-1"></a><span class="co">#&gt; 19                  888               580        190  454  1846      461     0</span></span>
<span id="cb168-102"><a href="cancer-epidemiology.html#cb168-102" tabindex="-1"></a><span class="co">#&gt; 20                 1409              2476        725  768   891     1329     0</span></span>
<span id="cb168-103"><a href="cancer-epidemiology.html#cb168-103" tabindex="-1"></a><span class="co">#&gt; 21                   57                 4          0    9    84        3     0</span></span>
<span id="cb168-104"><a href="cancer-epidemiology.html#cb168-104" tabindex="-1"></a><span class="co">#&gt; 22                  475               303         16  259  1466       92     0</span></span>
<span id="cb168-105"><a href="cancer-epidemiology.html#cb168-105" tabindex="-1"></a><span class="co">#&gt; 23                 1561              1168        174  920  3166      923     0</span></span>
<span id="cb168-106"><a href="cancer-epidemiology.html#cb168-106" tabindex="-1"></a><span class="co">#&gt; 24                 1883              3268        624 1091  1128     2101     0</span></span>
<span id="cb168-107"><a href="cancer-epidemiology.html#cb168-107" tabindex="-1"></a><span class="co">#&gt; 25                   25                 0          0    1     0        3     0</span></span>
<span id="cb168-108"><a href="cancer-epidemiology.html#cb168-108" tabindex="-1"></a><span class="co">#&gt;    Placenta Prostate Sarcoma Small.intestine Stomach Testis Thymus Thyroid</span></span>
<span id="cb168-109"><a href="cancer-epidemiology.html#cb168-109" tabindex="-1"></a><span class="co">#&gt; 1         0        0     137               0       5     61     12      22</span></span>
<span id="cb168-110"><a href="cancer-epidemiology.html#cb168-110" tabindex="-1"></a><span class="co">#&gt; 2         0       10     320              31     429    275     71     250</span></span>
<span id="cb168-111"><a href="cancer-epidemiology.html#cb168-111" tabindex="-1"></a><span class="co">#&gt; 3         0      481     281             102    1990     80     70     288</span></span>
<span id="cb168-112"><a href="cancer-epidemiology.html#cb168-112" tabindex="-1"></a><span class="co">#&gt; 4         0     3073     261             131    3634    129     59     194</span></span>
<span id="cb168-113"><a href="cancer-epidemiology.html#cb168-113" tabindex="-1"></a><span class="co">#&gt; 5         0        0     118               0       6     57     16      21</span></span>
<span id="cb168-114"><a href="cancer-epidemiology.html#cb168-114" tabindex="-1"></a><span class="co">#&gt; 6         0        6     307              34     331    395     96     333</span></span>
<span id="cb168-115"><a href="cancer-epidemiology.html#cb168-115" tabindex="-1"></a><span class="co">#&gt; 7         0     1588     367             113    1954     65    137     447</span></span>
<span id="cb168-116"><a href="cancer-epidemiology.html#cb168-116" tabindex="-1"></a><span class="co">#&gt; 8         0     8676     316             163    4256     44     94     278</span></span>
<span id="cb168-117"><a href="cancer-epidemiology.html#cb168-117" tabindex="-1"></a><span class="co">#&gt; 9         0        1     110               1       2     53     23      17</span></span>
<span id="cb168-118"><a href="cancer-epidemiology.html#cb168-118" tabindex="-1"></a><span class="co">#&gt; 10        0       18     299              46     192    587     68     496</span></span>
<span id="cb168-119"><a href="cancer-epidemiology.html#cb168-119" tabindex="-1"></a><span class="co">#&gt; 11        0     4128     527             293    2158    100    137     834</span></span>
<span id="cb168-120"><a href="cancer-epidemiology.html#cb168-120" tabindex="-1"></a><span class="co">#&gt; 12        0    14703     507             336    4720     15     85     424</span></span>
<span id="cb168-121"><a href="cancer-epidemiology.html#cb168-121" tabindex="-1"></a><span class="co">#&gt; 13        1        0     128               1       1      0      3      80</span></span>
<span id="cb168-122"><a href="cancer-epidemiology.html#cb168-122" tabindex="-1"></a><span class="co">#&gt; 14       13        0     283              22     492      0     38    1294</span></span>
<span id="cb168-123"><a href="cancer-epidemiology.html#cb168-123" tabindex="-1"></a><span class="co">#&gt; 15        0        0     232              53     826      0     38     788</span></span>
<span id="cb168-124"><a href="cancer-epidemiology.html#cb168-124" tabindex="-1"></a><span class="co">#&gt; 16        0        0     232             116    2319      0     38     479</span></span>
<span id="cb168-125"><a href="cancer-epidemiology.html#cb168-125" tabindex="-1"></a><span class="co">#&gt; 17        0        0     105               0       2      0      1      81</span></span>
<span id="cb168-126"><a href="cancer-epidemiology.html#cb168-126" tabindex="-1"></a><span class="co">#&gt; 18        8        0     322              24     379      0     64    1659</span></span>
<span id="cb168-127"><a href="cancer-epidemiology.html#cb168-127" tabindex="-1"></a><span class="co">#&gt; 19        3        0     300              80     971      0    116    1570</span></span>
<span id="cb168-128"><a href="cancer-epidemiology.html#cb168-128" tabindex="-1"></a><span class="co">#&gt; 20        0        0     247             153    2512      0     65     595</span></span>
<span id="cb168-129"><a href="cancer-epidemiology.html#cb168-129" tabindex="-1"></a><span class="co">#&gt; 21        0        0      86               1       0      0      5     103</span></span>
<span id="cb168-130"><a href="cancer-epidemiology.html#cb168-130" tabindex="-1"></a><span class="co">#&gt; 22       12        0     330              38     318      0     30    2291</span></span>
<span id="cb168-131"><a href="cancer-epidemiology.html#cb168-131" tabindex="-1"></a><span class="co">#&gt; 23        3        0     509             221    1653      0     81    3200</span></span>
<span id="cb168-132"><a href="cancer-epidemiology.html#cb168-132" tabindex="-1"></a><span class="co">#&gt; 24        0        0     351             251    2809      0     67     940</span></span>
<span id="cb168-133"><a href="cancer-epidemiology.html#cb168-133" tabindex="-1"></a><span class="co">#&gt; 25        0        0      41               1       0      2      7       1</span></span>
<span id="cb168-134"><a href="cancer-epidemiology.html#cb168-134" tabindex="-1"></a><span class="co">#&gt;    Uterus Vulva</span></span>
<span id="cb168-135"><a href="cancer-epidemiology.html#cb168-135" tabindex="-1"></a><span class="co">#&gt; 1       0     0</span></span>
<span id="cb168-136"><a href="cancer-epidemiology.html#cb168-136" tabindex="-1"></a><span class="co">#&gt; 2       0     0</span></span>
<span id="cb168-137"><a href="cancer-epidemiology.html#cb168-137" tabindex="-1"></a><span class="co">#&gt; 3       0     0</span></span>
<span id="cb168-138"><a href="cancer-epidemiology.html#cb168-138" tabindex="-1"></a><span class="co">#&gt; 4       0     0</span></span>
<span id="cb168-139"><a href="cancer-epidemiology.html#cb168-139" tabindex="-1"></a><span class="co">#&gt; 5       0     0</span></span>
<span id="cb168-140"><a href="cancer-epidemiology.html#cb168-140" tabindex="-1"></a><span class="co">#&gt; 6       0     0</span></span>
<span id="cb168-141"><a href="cancer-epidemiology.html#cb168-141" tabindex="-1"></a><span class="co">#&gt; 7       0     0</span></span>
<span id="cb168-142"><a href="cancer-epidemiology.html#cb168-142" tabindex="-1"></a><span class="co">#&gt; 8       0     0</span></span>
<span id="cb168-143"><a href="cancer-epidemiology.html#cb168-143" tabindex="-1"></a><span class="co">#&gt; 9       0     0</span></span>
<span id="cb168-144"><a href="cancer-epidemiology.html#cb168-144" tabindex="-1"></a><span class="co">#&gt; 10      0     0</span></span>
<span id="cb168-145"><a href="cancer-epidemiology.html#cb168-145" tabindex="-1"></a><span class="co">#&gt; 11      0     0</span></span>
<span id="cb168-146"><a href="cancer-epidemiology.html#cb168-146" tabindex="-1"></a><span class="co">#&gt; 12      0     0</span></span>
<span id="cb168-147"><a href="cancer-epidemiology.html#cb168-147" tabindex="-1"></a><span class="co">#&gt; 13      2     1</span></span>
<span id="cb168-148"><a href="cancer-epidemiology.html#cb168-148" tabindex="-1"></a><span class="co">#&gt; 14    478    49</span></span>
<span id="cb168-149"><a href="cancer-epidemiology.html#cb168-149" tabindex="-1"></a><span class="co">#&gt; 15   1362    96</span></span>
<span id="cb168-150"><a href="cancer-epidemiology.html#cb168-150" tabindex="-1"></a><span class="co">#&gt; 16    729   235</span></span>
<span id="cb168-151"><a href="cancer-epidemiology.html#cb168-151" tabindex="-1"></a><span class="co">#&gt; 17      2     2</span></span>
<span id="cb168-152"><a href="cancer-epidemiology.html#cb168-152" tabindex="-1"></a><span class="co">#&gt; 18    821    44</span></span>
<span id="cb168-153"><a href="cancer-epidemiology.html#cb168-153" tabindex="-1"></a><span class="co">#&gt; 19   3071   147</span></span>
<span id="cb168-154"><a href="cancer-epidemiology.html#cb168-154" tabindex="-1"></a><span class="co">#&gt; 20   1130   336</span></span>
<span id="cb168-155"><a href="cancer-epidemiology.html#cb168-155" tabindex="-1"></a><span class="co">#&gt; 21      3     1</span></span>
<span id="cb168-156"><a href="cancer-epidemiology.html#cb168-156" tabindex="-1"></a><span class="co">#&gt; 22   1165    57</span></span>
<span id="cb168-157"><a href="cancer-epidemiology.html#cb168-157" tabindex="-1"></a><span class="co">#&gt; 23   6582   235</span></span>
<span id="cb168-158"><a href="cancer-epidemiology.html#cb168-158" tabindex="-1"></a><span class="co">#&gt; 24   1864   486</span></span>
<span id="cb168-159"><a href="cancer-epidemiology.html#cb168-159" tabindex="-1"></a><span class="co">#&gt; 25      0     0</span></span>
<span id="cb168-160"><a href="cancer-epidemiology.html#cb168-160" tabindex="-1"></a><span class="co">#&gt;  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 23 rows ]</span></span></code></pre></div>
</div>
<div id="a.-visualise-changes-in-incidence-and-mortality" class="section level3 hasAnchor" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> 3a. Visualise changes in incidence and mortality<a href="cancer-epidemiology.html#a.-visualise-changes-in-incidence-and-mortality" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="cancer-epidemiology.html#cb169-1" tabindex="-1"></a><span class="co"># first plot incidence for each cancer type</span></span>
<span id="cb169-2"><a href="cancer-epidemiology.html#cb169-2" tabindex="-1"></a></span>
<span id="cb169-3"><a href="cancer-epidemiology.html#cb169-3" tabindex="-1"></a><span class="co">#Import the necessary packages and libraries</span></span>
<span id="cb169-4"><a href="cancer-epidemiology.html#cb169-4" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;ggplot2&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;gglot2&quot;</span>)</span>
<span id="cb169-5"><a href="cancer-epidemiology.html#cb169-5" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;gridExtra&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;gridExtra&quot;</span>)</span>
<span id="cb169-6"><a href="cancer-epidemiology.html#cb169-6" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;ggpubr&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;ggpubr&quot;</span>)</span>
<span id="cb169-7"><a href="cancer-epidemiology.html#cb169-7" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb169-8"><a href="cancer-epidemiology.html#cb169-8" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb169-9"><a href="cancer-epidemiology.html#cb169-9" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb169-10"><a href="cancer-epidemiology.html#cb169-10" tabindex="-1"></a></span>
<span id="cb169-11"><a href="cancer-epidemiology.html#cb169-11" tabindex="-1"></a>HKCancer_inc <span class="ot">&lt;-</span> HKCancer[HKCancer<span class="sc">$</span>Type<span class="sc">==</span><span class="st">&#39;incidence&#39;</span>,]</span>
<span id="cb169-12"><a href="cancer-epidemiology.html#cb169-12" tabindex="-1"></a></span>
<span id="cb169-13"><a href="cancer-epidemiology.html#cb169-13" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb169-14"><a href="cancer-epidemiology.html#cb169-14" tabindex="-1"></a></span>
<span id="cb169-15"><a href="cancer-epidemiology.html#cb169-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(HKCancer_inc)<span class="sc">-</span><span class="dv">4</span>)){</span>
<span id="cb169-16"><a href="cancer-epidemiology.html#cb169-16" tabindex="-1"></a>  p[[i]]<span class="ot">&lt;-</span><span class="fu">ggplot</span>(HKCancer_inc,<span class="fu">aes_string</span>(<span class="at">fill=</span><span class="fu">names</span>(HKCancer_inc)[<span class="dv">3</span>],<span class="at">x=</span><span class="fu">names</span>(HKCancer_inc)[<span class="dv">4</span>],</span>
<span id="cb169-17"><a href="cancer-epidemiology.html#cb169-17" tabindex="-1"></a>                                         <span class="at">y=</span><span class="fu">names</span>(HKCancer_inc)[i<span class="sc">+</span><span class="dv">4</span>],<span class="at">group=</span><span class="fu">names</span>(HKCancer_inc)[<span class="dv">3</span>]))<span class="sc">+</span></span>
<span id="cb169-18"><a href="cancer-epidemiology.html#cb169-18" tabindex="-1"></a>       <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>,<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb169-19"><a href="cancer-epidemiology.html#cb169-19" tabindex="-1"></a>       <span class="fu">facet_wrap</span>(<span class="sc">~</span>Sex) <span class="sc">+</span></span>
<span id="cb169-20"><a href="cancer-epidemiology.html#cb169-20" tabindex="-1"></a>       <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb169-21"><a href="cancer-epidemiology.html#cb169-21" tabindex="-1"></a>       <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Spectral&quot;</span>)<span class="sc">+</span></span>
<span id="cb169-22"><a href="cancer-epidemiology.html#cb169-22" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb169-23"><a href="cancer-epidemiology.html#cb169-23" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))<span class="sc">+</span> </span>
<span id="cb169-24"><a href="cancer-epidemiology.html#cb169-24" tabindex="-1"></a>       <span class="fu">ggtitle</span>(<span class="fu">names</span>(HKCancer_inc)[i<span class="sc">+</span><span class="dv">4</span>])<span class="sc">+</span></span>
<span id="cb169-25"><a href="cancer-epidemiology.html#cb169-25" tabindex="-1"></a>       <span class="fu">ylab</span>(<span class="st">&quot;Incidence&quot;</span>)</span>
<span id="cb169-26"><a href="cancer-epidemiology.html#cb169-26" tabindex="-1"></a>}</span>
<span id="cb169-27"><a href="cancer-epidemiology.html#cb169-27" tabindex="-1"></a><span class="fu">do.call</span>(<span class="st">&#39;grid.arrange&#39;</span>,<span class="fu">c</span>(p,<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">nrow=</span><span class="dv">12</span>))</span></code></pre></div>
<p><img src="BMDatSci_files/figure-html/incidence-1.png" width="1344" /></p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="cancer-epidemiology.html#cb170-1" tabindex="-1"></a><span class="co"># now plot mortality for each cancer type</span></span>
<span id="cb170-2"><a href="cancer-epidemiology.html#cb170-2" tabindex="-1"></a></span>
<span id="cb170-3"><a href="cancer-epidemiology.html#cb170-3" tabindex="-1"></a><span class="co">#Import the necessary packages and libraries</span></span>
<span id="cb170-4"><a href="cancer-epidemiology.html#cb170-4" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;ggplot2&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;gglot2&quot;</span>)</span>
<span id="cb170-5"><a href="cancer-epidemiology.html#cb170-5" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;gridExtra&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;gridExtra&quot;</span>)</span>
<span id="cb170-6"><a href="cancer-epidemiology.html#cb170-6" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;ggpubr&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;ggpubr&quot;</span>)</span>
<span id="cb170-7"><a href="cancer-epidemiology.html#cb170-7" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;dplyr&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb170-8"><a href="cancer-epidemiology.html#cb170-8" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb170-9"><a href="cancer-epidemiology.html#cb170-9" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb170-10"><a href="cancer-epidemiology.html#cb170-10" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb170-11"><a href="cancer-epidemiology.html#cb170-11" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb170-12"><a href="cancer-epidemiology.html#cb170-12" tabindex="-1"></a></span>
<span id="cb170-13"><a href="cancer-epidemiology.html#cb170-13" tabindex="-1"></a>HKCancer_mort <span class="ot">&lt;-</span> HKCancer[HKCancer<span class="sc">$</span>Type<span class="sc">==</span><span class="st">&#39;mortality&#39;</span>,]</span>
<span id="cb170-14"><a href="cancer-epidemiology.html#cb170-14" tabindex="-1"></a></span>
<span id="cb170-15"><a href="cancer-epidemiology.html#cb170-15" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb170-16"><a href="cancer-epidemiology.html#cb170-16" tabindex="-1"></a><span class="co">#(ncol(HKCancer_inc)-4)</span></span>
<span id="cb170-17"><a href="cancer-epidemiology.html#cb170-17" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(HKCancer_mort)<span class="sc">-</span><span class="dv">4</span>)){</span>
<span id="cb170-18"><a href="cancer-epidemiology.html#cb170-18" tabindex="-1"></a>  p[[i]]<span class="ot">&lt;-</span><span class="fu">ggplot</span>(HKCancer_mort,<span class="fu">aes_string</span>(<span class="at">fill=</span><span class="fu">names</span>(HKCancer_mort)[<span class="dv">3</span>],<span class="at">x=</span><span class="fu">names</span>(HKCancer_mort)[<span class="dv">4</span>],</span>
<span id="cb170-19"><a href="cancer-epidemiology.html#cb170-19" tabindex="-1"></a>                                          <span class="at">y=</span><span class="fu">names</span>(HKCancer_mort)[i<span class="sc">+</span><span class="dv">4</span>],<span class="at">group=</span><span class="fu">names</span>(HKCancer_mort)[<span class="dv">3</span>]))<span class="sc">+</span></span>
<span id="cb170-20"><a href="cancer-epidemiology.html#cb170-20" tabindex="-1"></a>       <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>,<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb170-21"><a href="cancer-epidemiology.html#cb170-21" tabindex="-1"></a>       <span class="fu">facet_wrap</span>(<span class="sc">~</span>Sex) <span class="sc">+</span></span>
<span id="cb170-22"><a href="cancer-epidemiology.html#cb170-22" tabindex="-1"></a>       <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb170-23"><a href="cancer-epidemiology.html#cb170-23" tabindex="-1"></a>       <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Spectral&quot;</span>)<span class="sc">+</span></span>
<span id="cb170-24"><a href="cancer-epidemiology.html#cb170-24" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb170-25"><a href="cancer-epidemiology.html#cb170-25" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))<span class="sc">+</span> </span>
<span id="cb170-26"><a href="cancer-epidemiology.html#cb170-26" tabindex="-1"></a>       <span class="fu">ggtitle</span>(<span class="fu">names</span>(HKCancer_mort)[i<span class="sc">+</span><span class="dv">4</span>])<span class="sc">+</span></span>
<span id="cb170-27"><a href="cancer-epidemiology.html#cb170-27" tabindex="-1"></a>       <span class="fu">ylab</span>(<span class="st">&quot;Mortality&quot;</span>)</span>
<span id="cb170-28"><a href="cancer-epidemiology.html#cb170-28" tabindex="-1"></a>}</span>
<span id="cb170-29"><a href="cancer-epidemiology.html#cb170-29" tabindex="-1"></a><span class="fu">do.call</span>(<span class="st">&#39;grid.arrange&#39;</span>,<span class="fu">c</span>(p,<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">nrow=</span><span class="dv">12</span>))</span></code></pre></div>
<p><img src="BMDatSci_files/figure-html/mortality-1.png" width="1344" /></p>
</div>
<div id="b.-calculate-cancer-risk-and-mortality-rate" class="section level3 hasAnchor" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> 3b. Calculate cancer risk and mortality rate<a href="cancer-epidemiology.html#b.-calculate-cancer-risk-and-mortality-rate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To calculate disease risk we need to calculated the number of new cases over the number of persons at risk over a specific time period. We have the incidence for each decade and can estimate the number of persons at risk based on the population in 1995, 2005 and 2015.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="cancer-epidemiology.html#cb171-1" tabindex="-1"></a><span class="co"># cancer risk calculation</span></span>
<span id="cb171-2"><a href="cancer-epidemiology.html#cb171-2" tabindex="-1"></a></span>
<span id="cb171-3"><a href="cancer-epidemiology.html#cb171-3" tabindex="-1"></a>HKCancer_inc <span class="ot">&lt;-</span> HKCancer[HKCancer<span class="sc">$</span>Type<span class="sc">==</span><span class="st">&#39;incidence&#39;</span>,]</span>
<span id="cb171-4"><a href="cancer-epidemiology.html#cb171-4" tabindex="-1"></a>HKCancer_inc_risk <span class="ot">&lt;-</span> HKCancer_inc[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb171-5"><a href="cancer-epidemiology.html#cb171-5" tabindex="-1"></a></span>
<span id="cb171-6"><a href="cancer-epidemiology.html#cb171-6" tabindex="-1"></a>risk <span class="ot">&lt;-</span> <span class="cf">function</span>(x,age,sex,year){</span>
<span id="cb171-7"><a href="cancer-epidemiology.html#cb171-7" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.integer</span>(x)){</span>
<span id="cb171-8"><a href="cancer-epidemiology.html#cb171-8" tabindex="-1"></a>    pop_n <span class="ot">&lt;-</span> HKPop <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Sex<span class="sc">==</span>sex <span class="sc">&amp;</span> Age<span class="sc">==</span>age)</span>
<span id="cb171-9"><a href="cancer-epidemiology.html#cb171-9" tabindex="-1"></a>    <span class="cf">if</span> (year <span class="sc">==</span> <span class="st">&quot;1990-1999&quot;</span>){ <span class="fu">return</span> (<span class="fu">as.double</span>(x)<span class="sc">/</span><span class="fu">as.double</span>(pop_n<span class="sc">$</span><span class="st">`</span><span class="at">1995</span><span class="st">`</span>)) }</span>
<span id="cb171-10"><a href="cancer-epidemiology.html#cb171-10" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (year <span class="sc">==</span> <span class="st">&quot;2000-2009&quot;</span>) {<span class="fu">return</span> (<span class="fu">as.double</span>(x)<span class="sc">/</span><span class="fu">as.double</span>(pop_n<span class="sc">$</span><span class="st">`</span><span class="at">2005</span><span class="st">`</span>))}</span>
<span id="cb171-11"><a href="cancer-epidemiology.html#cb171-11" tabindex="-1"></a>    <span class="cf">else</span> { <span class="fu">return</span> (<span class="fu">as.double</span>(x)<span class="sc">/</span><span class="fu">as.double</span>(pop_n<span class="sc">$</span><span class="st">`</span><span class="at">2015</span><span class="st">`</span>)) }</span>
<span id="cb171-12"><a href="cancer-epidemiology.html#cb171-12" tabindex="-1"></a>  }</span>
<span id="cb171-13"><a href="cancer-epidemiology.html#cb171-13" tabindex="-1"></a>  <span class="fu">return</span> (x)</span>
<span id="cb171-14"><a href="cancer-epidemiology.html#cb171-14" tabindex="-1"></a>}</span>
<span id="cb171-15"><a href="cancer-epidemiology.html#cb171-15" tabindex="-1"></a></span>
<span id="cb171-16"><a href="cancer-epidemiology.html#cb171-16" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">5</span><span class="sc">:</span><span class="fu">ncol</span>(HKCancer_inc)){</span>
<span id="cb171-17"><a href="cancer-epidemiology.html#cb171-17" tabindex="-1"></a>  HKCancer_inc_risk[<span class="fu">names</span>(HKCancer_inc)[i]] <span class="ot">&lt;-</span> <span class="fu">mapply</span>(risk,HKCancer_inc[,i],HKCancer_inc[,<span class="dv">3</span>],HKCancer_inc[,<span class="dv">2</span>],HKCancer_inc[,<span class="dv">4</span>])</span>
<span id="cb171-18"><a href="cancer-epidemiology.html#cb171-18" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="cancer-epidemiology.html#cb172-1" tabindex="-1"></a><span class="co">#visualise cancer risk</span></span>
<span id="cb172-2"><a href="cancer-epidemiology.html#cb172-2" tabindex="-1"></a></span>
<span id="cb172-3"><a href="cancer-epidemiology.html#cb172-3" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb172-4"><a href="cancer-epidemiology.html#cb172-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(HKCancer_inc_risk)<span class="sc">-</span><span class="dv">4</span>)){</span>
<span id="cb172-5"><a href="cancer-epidemiology.html#cb172-5" tabindex="-1"></a>  p[[i]]<span class="ot">&lt;-</span><span class="fu">ggplot</span>(HKCancer_inc_risk,<span class="fu">aes_string</span>(<span class="at">fill=</span><span class="fu">names</span>(HKCancer_inc_risk)[<span class="dv">3</span>],<span class="at">x=</span><span class="fu">names</span>(HKCancer_inc_risk)[<span class="dv">4</span>],</span>
<span id="cb172-6"><a href="cancer-epidemiology.html#cb172-6" tabindex="-1"></a>                                              <span class="at">y=</span><span class="fu">names</span>(HKCancer_inc_risk)[i<span class="sc">+</span><span class="dv">4</span>],<span class="at">group=</span><span class="fu">names</span>(HKCancer_inc_risk)[<span class="dv">3</span>]))<span class="sc">+</span></span>
<span id="cb172-7"><a href="cancer-epidemiology.html#cb172-7" tabindex="-1"></a>       <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>,<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb172-8"><a href="cancer-epidemiology.html#cb172-8" tabindex="-1"></a>       <span class="fu">facet_wrap</span>(<span class="sc">~</span>Sex) <span class="sc">+</span></span>
<span id="cb172-9"><a href="cancer-epidemiology.html#cb172-9" tabindex="-1"></a>       <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb172-10"><a href="cancer-epidemiology.html#cb172-10" tabindex="-1"></a>       <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Spectral&quot;</span>)<span class="sc">+</span></span>
<span id="cb172-11"><a href="cancer-epidemiology.html#cb172-11" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb172-12"><a href="cancer-epidemiology.html#cb172-12" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))<span class="sc">+</span> </span>
<span id="cb172-13"><a href="cancer-epidemiology.html#cb172-13" tabindex="-1"></a>       <span class="fu">ggtitle</span>(<span class="fu">names</span>(HKCancer_inc)[i<span class="sc">+</span><span class="dv">4</span>])<span class="sc">+</span></span>
<span id="cb172-14"><a href="cancer-epidemiology.html#cb172-14" tabindex="-1"></a>       <span class="fu">ylab</span>(<span class="st">&quot;incidence per 1000&quot;</span>)</span>
<span id="cb172-15"><a href="cancer-epidemiology.html#cb172-15" tabindex="-1"></a>}</span>
<span id="cb172-16"><a href="cancer-epidemiology.html#cb172-16" tabindex="-1"></a><span class="fu">do.call</span>(<span class="st">&#39;grid.arrange&#39;</span>,<span class="fu">c</span>(p,<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">nrow=</span><span class="dv">12</span>))</span></code></pre></div>
<p><img src="BMDatSci_files/figure-html/cancer%20risk%20visulisation-1.png" width="1344" /></p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="cancer-epidemiology.html#cb173-1" tabindex="-1"></a><span class="co"># mortality rate calculation</span></span>
<span id="cb173-2"><a href="cancer-epidemiology.html#cb173-2" tabindex="-1"></a></span>
<span id="cb173-3"><a href="cancer-epidemiology.html#cb173-3" tabindex="-1"></a>HKCancer_mort <span class="ot">&lt;-</span> HKCancer[HKCancer<span class="sc">$</span>Type<span class="sc">==</span><span class="st">&#39;mortality&#39;</span>,]</span>
<span id="cb173-4"><a href="cancer-epidemiology.html#cb173-4" tabindex="-1"></a>HKCancer_mort_risk <span class="ot">&lt;-</span> HKCancer_mort[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb173-5"><a href="cancer-epidemiology.html#cb173-5" tabindex="-1"></a></span>
<span id="cb173-6"><a href="cancer-epidemiology.html#cb173-6" tabindex="-1"></a>risk <span class="ot">&lt;-</span> <span class="cf">function</span>(x,age,sex,year){</span>
<span id="cb173-7"><a href="cancer-epidemiology.html#cb173-7" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.integer</span>(x)){</span>
<span id="cb173-8"><a href="cancer-epidemiology.html#cb173-8" tabindex="-1"></a>    pop_n <span class="ot">&lt;-</span> HKPop <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Sex<span class="sc">==</span>sex <span class="sc">&amp;</span> Age<span class="sc">==</span>age)</span>
<span id="cb173-9"><a href="cancer-epidemiology.html#cb173-9" tabindex="-1"></a>    <span class="cf">if</span> (year <span class="sc">==</span> <span class="st">&quot;1990-1999&quot;</span>){ <span class="fu">return</span> (<span class="fu">as.double</span>(x)<span class="sc">/</span><span class="fu">as.double</span>(pop_n<span class="sc">$</span><span class="st">`</span><span class="at">1995</span><span class="st">`</span>)) }</span>
<span id="cb173-10"><a href="cancer-epidemiology.html#cb173-10" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (year <span class="sc">==</span> <span class="st">&quot;2000-2009&quot;</span>) {<span class="fu">return</span> (<span class="fu">as.double</span>(x)<span class="sc">/</span><span class="fu">as.double</span>(pop_n<span class="sc">$</span><span class="st">`</span><span class="at">2005</span><span class="st">`</span>))}</span>
<span id="cb173-11"><a href="cancer-epidemiology.html#cb173-11" tabindex="-1"></a>    <span class="cf">else</span> { <span class="fu">return</span> (<span class="fu">as.double</span>(x)<span class="sc">/</span><span class="fu">as.double</span>(pop_n<span class="sc">$</span><span class="st">`</span><span class="at">2015</span><span class="st">`</span>)) }</span>
<span id="cb173-12"><a href="cancer-epidemiology.html#cb173-12" tabindex="-1"></a>  }</span>
<span id="cb173-13"><a href="cancer-epidemiology.html#cb173-13" tabindex="-1"></a>  <span class="fu">return</span> (x)</span>
<span id="cb173-14"><a href="cancer-epidemiology.html#cb173-14" tabindex="-1"></a>}</span>
<span id="cb173-15"><a href="cancer-epidemiology.html#cb173-15" tabindex="-1"></a></span>
<span id="cb173-16"><a href="cancer-epidemiology.html#cb173-16" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">5</span><span class="sc">:</span><span class="fu">ncol</span>(HKCancer_mort)){</span>
<span id="cb173-17"><a href="cancer-epidemiology.html#cb173-17" tabindex="-1"></a>  HKCancer_mort_risk[<span class="fu">names</span>(HKCancer_mort)[i]] <span class="ot">&lt;-</span> <span class="fu">mapply</span>(risk,HKCancer_mort[,i],HKCancer_mort[,<span class="dv">3</span>],HKCancer_mort[,<span class="dv">2</span>],HKCancer_mort[,<span class="dv">4</span>])</span>
<span id="cb173-18"><a href="cancer-epidemiology.html#cb173-18" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="cancer-epidemiology.html#cb174-1" tabindex="-1"></a><span class="co">#visualise mortality rate</span></span>
<span id="cb174-2"><a href="cancer-epidemiology.html#cb174-2" tabindex="-1"></a></span>
<span id="cb174-3"><a href="cancer-epidemiology.html#cb174-3" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb174-4"><a href="cancer-epidemiology.html#cb174-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(HKCancer_mort_risk)<span class="sc">-</span><span class="dv">4</span>)){</span>
<span id="cb174-5"><a href="cancer-epidemiology.html#cb174-5" tabindex="-1"></a>  p[[i]]<span class="ot">&lt;-</span><span class="fu">ggplot</span>(HKCancer_mort_risk,<span class="fu">aes_string</span>(<span class="at">fill=</span><span class="fu">names</span>(HKCancer_mort_risk)[<span class="dv">3</span>],<span class="at">x=</span><span class="fu">names</span>(HKCancer_mort_risk)[<span class="dv">4</span>],</span>
<span id="cb174-6"><a href="cancer-epidemiology.html#cb174-6" tabindex="-1"></a>                                               <span class="at">y=</span><span class="fu">names</span>(HKCancer_mort_risk)[i<span class="sc">+</span><span class="dv">4</span>],<span class="at">group=</span><span class="fu">names</span>(HKCancer_mort_risk)[<span class="dv">3</span>]))<span class="sc">+</span></span>
<span id="cb174-7"><a href="cancer-epidemiology.html#cb174-7" tabindex="-1"></a>       <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>,<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb174-8"><a href="cancer-epidemiology.html#cb174-8" tabindex="-1"></a>       <span class="fu">facet_wrap</span>(<span class="sc">~</span>Sex) <span class="sc">+</span></span>
<span id="cb174-9"><a href="cancer-epidemiology.html#cb174-9" tabindex="-1"></a>       <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb174-10"><a href="cancer-epidemiology.html#cb174-10" tabindex="-1"></a>       <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Spectral&quot;</span>)<span class="sc">+</span></span>
<span id="cb174-11"><a href="cancer-epidemiology.html#cb174-11" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb174-12"><a href="cancer-epidemiology.html#cb174-12" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))<span class="sc">+</span> </span>
<span id="cb174-13"><a href="cancer-epidemiology.html#cb174-13" tabindex="-1"></a>       <span class="fu">ggtitle</span>(<span class="fu">names</span>(HKCancer_inc)[i<span class="sc">+</span><span class="dv">4</span>])<span class="sc">+</span></span>
<span id="cb174-14"><a href="cancer-epidemiology.html#cb174-14" tabindex="-1"></a>       <span class="fu">ylab</span>(<span class="st">&quot;mortality per 1000&quot;</span>)</span>
<span id="cb174-15"><a href="cancer-epidemiology.html#cb174-15" tabindex="-1"></a>}</span>
<span id="cb174-16"><a href="cancer-epidemiology.html#cb174-16" tabindex="-1"></a><span class="fu">do.call</span>(<span class="st">&#39;grid.arrange&#39;</span>,<span class="fu">c</span>(p,<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">nrow=</span><span class="dv">12</span>))</span></code></pre></div>
<p><img src="BMDatSci_files/figure-html/mortality%20rate%20visulisation-1.png" width="1344" /></p>
</div>
<div id="c.-mortality-incidence-ratio" class="section level3 hasAnchor" number="9.3.4">
<h3><span class="header-section-number">9.3.4</span> 3c. Mortality-incidence ratio<a href="cancer-epidemiology.html#c.-mortality-incidence-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Cancer research can be focused on improving cancer outcomes in a number of ways. For example cancer prevention research that seeks to reduce cancer incidence which would also ultimately reduce cancer mortality. Another area is cancer therapy which would not affect incidence but seeks to reduce mortality, or at least prolong survival. We don’t go into survival analysis in this tutorial, but a way to get an idea whether treatment is improving by looking at the mortality-incidence ratio.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="cancer-epidemiology.html#cb175-1" tabindex="-1"></a></span>
<span id="cb175-2"><a href="cancer-epidemiology.html#cb175-2" tabindex="-1"></a>HKCancer_inc <span class="ot">&lt;-</span> HKCancer[HKCancer<span class="sc">$</span>Type<span class="sc">==</span><span class="st">&#39;incidence&#39;</span>,]</span>
<span id="cb175-3"><a href="cancer-epidemiology.html#cb175-3" tabindex="-1"></a>HKCancer_mort <span class="ot">&lt;-</span> HKCancer[HKCancer<span class="sc">$</span>Type<span class="sc">==</span><span class="st">&#39;mortality&#39;</span>,]</span>
<span id="cb175-4"><a href="cancer-epidemiology.html#cb175-4" tabindex="-1"></a>HKCancer_mort_inc <span class="ot">&lt;-</span> HKCancer_mort[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb175-5"><a href="cancer-epidemiology.html#cb175-5" tabindex="-1"></a></span>
<span id="cb175-6"><a href="cancer-epidemiology.html#cb175-6" tabindex="-1"></a>risk <span class="ot">&lt;-</span> <span class="cf">function</span>(mort,inc){</span>
<span id="cb175-7"><a href="cancer-epidemiology.html#cb175-7" tabindex="-1"></a>  <span class="cf">if</span> (inc <span class="sc">==</span> <span class="dv">0</span>){ <span class="fu">return</span> (<span class="dv">0</span>) }</span>
<span id="cb175-8"><a href="cancer-epidemiology.html#cb175-8" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">as.double</span>(mort)<span class="sc">/</span><span class="fu">as.double</span>(inc))</span>
<span id="cb175-9"><a href="cancer-epidemiology.html#cb175-9" tabindex="-1"></a>}</span>
<span id="cb175-10"><a href="cancer-epidemiology.html#cb175-10" tabindex="-1"></a></span>
<span id="cb175-11"><a href="cancer-epidemiology.html#cb175-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">5</span><span class="sc">:</span><span class="fu">ncol</span>(HKCancer_mort)){</span>
<span id="cb175-12"><a href="cancer-epidemiology.html#cb175-12" tabindex="-1"></a>  HKCancer_mort_inc[<span class="fu">names</span>(HKCancer_mort)[i]] <span class="ot">&lt;-</span> <span class="fu">mapply</span>(risk,HKCancer_mort[,i],HKCancer_inc[,i])</span>
<span id="cb175-13"><a href="cancer-epidemiology.html#cb175-13" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="cancer-epidemiology.html#cb176-1" tabindex="-1"></a><span class="co">#visualise mortality incidence ratio</span></span>
<span id="cb176-2"><a href="cancer-epidemiology.html#cb176-2" tabindex="-1"></a></span>
<span id="cb176-3"><a href="cancer-epidemiology.html#cb176-3" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb176-4"><a href="cancer-epidemiology.html#cb176-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(HKCancer_mort_inc)<span class="sc">-</span><span class="dv">4</span>)){</span>
<span id="cb176-5"><a href="cancer-epidemiology.html#cb176-5" tabindex="-1"></a>  p[[i]]<span class="ot">&lt;-</span><span class="fu">ggplot</span>(HKCancer_mort_inc,<span class="fu">aes_string</span>(<span class="at">fill=</span><span class="fu">names</span>(HKCancer_mort_inc)[<span class="dv">3</span>],<span class="at">x=</span><span class="fu">names</span>(HKCancer_mort_inc)[<span class="dv">4</span>],</span>
<span id="cb176-6"><a href="cancer-epidemiology.html#cb176-6" tabindex="-1"></a>                                              <span class="at">y=</span><span class="fu">names</span>(HKCancer_mort_inc)[i<span class="sc">+</span><span class="dv">4</span>],<span class="at">group=</span><span class="fu">names</span>(HKCancer_mort_inc)[<span class="dv">3</span>]))<span class="sc">+</span></span>
<span id="cb176-7"><a href="cancer-epidemiology.html#cb176-7" tabindex="-1"></a>       <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>,<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb176-8"><a href="cancer-epidemiology.html#cb176-8" tabindex="-1"></a>       <span class="fu">facet_wrap</span>(<span class="sc">~</span>Sex) <span class="sc">+</span></span>
<span id="cb176-9"><a href="cancer-epidemiology.html#cb176-9" tabindex="-1"></a>       <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb176-10"><a href="cancer-epidemiology.html#cb176-10" tabindex="-1"></a>       <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Spectral&quot;</span>)<span class="sc">+</span></span>
<span id="cb176-11"><a href="cancer-epidemiology.html#cb176-11" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb176-12"><a href="cancer-epidemiology.html#cb176-12" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))<span class="sc">+</span> </span>
<span id="cb176-13"><a href="cancer-epidemiology.html#cb176-13" tabindex="-1"></a>       <span class="fu">ggtitle</span>(<span class="fu">names</span>(HKCancer_inc)[i<span class="sc">+</span><span class="dv">4</span>])<span class="sc">+</span></span>
<span id="cb176-14"><a href="cancer-epidemiology.html#cb176-14" tabindex="-1"></a>       <span class="fu">ylab</span>(<span class="st">&quot;mortality-incidence ratio&quot;</span>)</span>
<span id="cb176-15"><a href="cancer-epidemiology.html#cb176-15" tabindex="-1"></a>}</span>
<span id="cb176-16"><a href="cancer-epidemiology.html#cb176-16" tabindex="-1"></a><span class="fu">do.call</span>(<span class="st">&#39;grid.arrange&#39;</span>,<span class="fu">c</span>(p,<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">nrow=</span><span class="dv">12</span>))</span></code></pre></div>
<p><img src="BMDatSci_files/figure-html/mortality%20incidence%20ratio%20visulisation-1.png" width="1344" /></p>
</div>
<div id="d.-paired-t-test-on-mortality-incidence-ratio-change" class="section level3 hasAnchor" number="9.3.5">
<h3><span class="header-section-number">9.3.5</span> 3d. Paired t-test on mortality-incidence ratio change<a href="cancer-epidemiology.html#d.-paired-t-test-on-mortality-incidence-ratio-change" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In general, across the different cancer types is cancer treatment improving? We can use a paired t-test comparing the mortality-incidence ratio of cancers from the 1990-1999 period with the 2010-2019 period.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="cancer-epidemiology.html#cb177-1" tabindex="-1"></a></span>
<span id="cb177-2"><a href="cancer-epidemiology.html#cb177-2" tabindex="-1"></a><span class="co">#First sum up all incidence and mortality data for each cancer type across age and sex</span></span>
<span id="cb177-3"><a href="cancer-epidemiology.html#cb177-3" tabindex="-1"></a></span>
<span id="cb177-4"><a href="cancer-epidemiology.html#cb177-4" tabindex="-1"></a>HKCancer_inc_sum <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(HKCancer_inc[,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)],<span class="fu">list</span>(HKCancer_inc<span class="sc">$</span>Year),<span class="at">FUN=</span>sum)</span>
<span id="cb177-5"><a href="cancer-epidemiology.html#cb177-5" tabindex="-1"></a>HKCancer_mort_sum <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(HKCancer_mort[,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)],<span class="fu">list</span>(HKCancer_mort<span class="sc">$</span>Year),<span class="at">FUN=</span>sum)</span>
<span id="cb177-6"><a href="cancer-epidemiology.html#cb177-6" tabindex="-1"></a>HKCancer_mort_inc_year <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Year=</span>HKCancer_mort_sum[,<span class="dv">1</span>])</span>
<span id="cb177-7"><a href="cancer-epidemiology.html#cb177-7" tabindex="-1"></a></span>
<span id="cb177-8"><a href="cancer-epidemiology.html#cb177-8" tabindex="-1"></a>risk <span class="ot">&lt;-</span> <span class="cf">function</span>(mort,inc){</span>
<span id="cb177-9"><a href="cancer-epidemiology.html#cb177-9" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">as.double</span>(mort)<span class="sc">/</span><span class="fu">as.double</span>(inc))</span>
<span id="cb177-10"><a href="cancer-epidemiology.html#cb177-10" tabindex="-1"></a>}</span>
<span id="cb177-11"><a href="cancer-epidemiology.html#cb177-11" tabindex="-1"></a></span>
<span id="cb177-12"><a href="cancer-epidemiology.html#cb177-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(HKCancer_mort_sum)){</span>
<span id="cb177-13"><a href="cancer-epidemiology.html#cb177-13" tabindex="-1"></a>  HKCancer_mort_inc_year[<span class="fu">names</span>(HKCancer_mort_sum)[i]] <span class="ot">&lt;-</span> <span class="fu">mapply</span>(risk,HKCancer_mort_sum[,i],HKCancer_inc_sum[,i])</span>
<span id="cb177-14"><a href="cancer-epidemiology.html#cb177-14" tabindex="-1"></a>}</span>
<span id="cb177-15"><a href="cancer-epidemiology.html#cb177-15" tabindex="-1"></a></span>
<span id="cb177-16"><a href="cancer-epidemiology.html#cb177-16" tabindex="-1"></a>HKCancer_mort_inc_year_m <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="st">`</span><span class="at">1990-1999</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(HKCancer_mort_inc_year[<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">37</span>]),</span>
<span id="cb177-17"><a href="cancer-epidemiology.html#cb177-17" tabindex="-1"></a>                                    <span class="st">`</span><span class="at">2000-2009</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(HKCancer_mort_inc_year[<span class="dv">2</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">37</span>]),</span>
<span id="cb177-18"><a href="cancer-epidemiology.html#cb177-18" tabindex="-1"></a>                                    <span class="st">`</span><span class="at">2010-2019</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(HKCancer_mort_inc_year[<span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">37</span>]),</span>
<span id="cb177-19"><a href="cancer-epidemiology.html#cb177-19" tabindex="-1"></a>                                    <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb177-20"><a href="cancer-epidemiology.html#cb177-20" tabindex="-1"></a></span>
<span id="cb177-21"><a href="cancer-epidemiology.html#cb177-21" tabindex="-1"></a>HKCancer_mort_inc_year_m<span class="sc">$</span>Cancer <span class="ot">&lt;-</span> <span class="fu">names</span>(HKCancer_mort_inc_year)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb177-22"><a href="cancer-epidemiology.html#cb177-22" tabindex="-1"></a></span>
<span id="cb177-23"><a href="cancer-epidemiology.html#cb177-23" tabindex="-1"></a>HKCancer_mort_inc_year_t<span class="ot">&lt;-</span><span class="fu">as_tibble</span>(HKCancer_mort_inc_year_m) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">Cancer</span><span class="st">`</span>,<span class="st">`</span><span class="at">1990-1999</span><span class="st">`</span>,<span class="st">`</span><span class="at">2000-2009</span><span class="st">`</span>,<span class="st">`</span><span class="at">2010-2019</span><span class="st">`</span>)<span class="sc">%&gt;%</span> <span class="fu">gather</span> (<span class="at">key=</span><span class="st">&quot;Year&quot;</span>,<span class="at">value=</span><span class="st">&quot;MIR&quot;</span>,<span class="sc">-</span>Cancer)</span>
<span id="cb177-24"><a href="cancer-epidemiology.html#cb177-24" tabindex="-1"></a></span>
<span id="cb177-25"><a href="cancer-epidemiology.html#cb177-25" tabindex="-1"></a>plot<span class="ot">&lt;-</span><span class="fu">ggplot</span>(HKCancer_mort_inc_year_t,<span class="fu">aes</span>(<span class="at">x=</span>Year,<span class="at">y=</span>MIR, <span class="at">color=</span>Year))<span class="sc">+</span></span>
<span id="cb177-26"><a href="cancer-epidemiology.html#cb177-26" tabindex="-1"></a>       <span class="fu">geom_boxplot</span>(<span class="at">na.rm=</span>T) <span class="sc">+</span></span>
<span id="cb177-27"><a href="cancer-epidemiology.html#cb177-27" tabindex="-1"></a>       <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb177-28"><a href="cancer-epidemiology.html#cb177-28" tabindex="-1"></a>       <span class="fu">scale_color_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Dark2&quot;</span>)<span class="sc">+</span></span>
<span id="cb177-29"><a href="cancer-epidemiology.html#cb177-29" tabindex="-1"></a>       <span class="fu">geom_jitter</span>(<span class="at">shape=</span><span class="dv">16</span>, <span class="at">position=</span><span class="fu">position_jitter</span>(<span class="fl">0.2</span>),<span class="at">na.rm=</span>T)<span class="sc">+</span></span>
<span id="cb177-30"><a href="cancer-epidemiology.html#cb177-30" tabindex="-1"></a>       <span class="fu">ylab</span>(<span class="st">&quot;mortality-incidence ratio&quot;</span>)<span class="sc">+</span></span>
<span id="cb177-31"><a href="cancer-epidemiology.html#cb177-31" tabindex="-1"></a>       <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="fl">1.2</span>) <span class="sc">+</span> <span class="fu">geom_signif</span>(<span class="at">comparisons =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;1990-1999&quot;</span>, <span class="st">&quot;2010-2019&quot;</span>)),</span>
<span id="cb177-32"><a href="cancer-epidemiology.html#cb177-32" tabindex="-1"></a>                                 <span class="at">map_signif_level=</span>F, <span class="at">test=</span> <span class="st">&quot;t.test&quot;</span>,<span class="at">test.args =</span> <span class="fu">list</span>(<span class="at">paired =</span> <span class="cn">TRUE</span>), <span class="at">na.rm =</span> T, <span class="at">y_position =</span> <span class="fu">c</span>(<span class="fl">1.1</span>, <span class="fl">1.3</span>)) <span class="sc">+</span></span>
<span id="cb177-33"><a href="cancer-epidemiology.html#cb177-33" tabindex="-1"></a>       <span class="fu">geom_signif</span>(<span class="at">comparisons =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;1990-1999&quot;</span>, <span class="st">&quot;2000-2009&quot;</span>)), <span class="at">map_signif_level=</span>F, <span class="at">test=</span> <span class="st">&quot;t.test&quot;</span>,<span class="at">test.args =</span> <span class="fu">list</span>(<span class="at">paired =</span> <span class="cn">TRUE</span>), <span class="at">na.rm =</span> T) <span class="sc">+</span></span>
<span id="cb177-34"><a href="cancer-epidemiology.html#cb177-34" tabindex="-1"></a>       <span class="fu">geom_signif</span>(<span class="at">comparisons =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;2000-2009&quot;</span>, <span class="st">&quot;2010-2019&quot;</span>)), <span class="at">map_signif_level=</span>F, <span class="at">test=</span> <span class="st">&quot;t.test&quot;</span>,<span class="at">test.args =</span> <span class="fu">list</span>(<span class="at">paired =</span> <span class="cn">TRUE</span>), <span class="at">na.rm =</span> T)</span>
<span id="cb177-35"><a href="cancer-epidemiology.html#cb177-35" tabindex="-1"></a>plot</span></code></pre></div>
<p><img src="BMDatSci_files/figure-html/paired%20t-test-1.png" width="480" /></p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="cancer-epidemiology.html#cb178-1" tabindex="-1"></a></span>
<span id="cb178-2"><a href="cancer-epidemiology.html#cb178-2" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb178-3"><a href="cancer-epidemiology.html#cb178-3" tabindex="-1"></a>p[[<span class="dv">1</span>]]<span class="ot">&lt;-</span><span class="fu">t.test</span>(HKCancer_mort_inc_year_m<span class="sc">$</span><span class="st">`</span><span class="at">1990-1999</span><span class="st">`</span>,HKCancer_mort_inc_year_m<span class="sc">$</span><span class="st">`</span><span class="at">2000-2009</span><span class="st">`</span>,<span class="at">paired=</span><span class="cn">TRUE</span>,<span class="at">alternative_m =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb178-4"><a href="cancer-epidemiology.html#cb178-4" tabindex="-1"></a>p[[<span class="dv">2</span>]]<span class="ot">&lt;-</span><span class="fu">t.test</span>(HKCancer_mort_inc_year_m<span class="sc">$</span><span class="st">`</span><span class="at">1990-1999</span><span class="st">`</span>,HKCancer_mort_inc_year_m<span class="sc">$</span><span class="st">`</span><span class="at">2010-2019</span><span class="st">`</span>,<span class="at">paired=</span><span class="cn">TRUE</span>,<span class="at">alternative_m =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb178-5"><a href="cancer-epidemiology.html#cb178-5" tabindex="-1"></a>p[[<span class="dv">3</span>]]<span class="ot">&lt;-</span><span class="fu">t.test</span>(HKCancer_mort_inc_year_m<span class="sc">$</span><span class="st">`</span><span class="at">2000-2009</span><span class="st">`</span>,HKCancer_mort_inc_year_m<span class="sc">$</span><span class="st">`</span><span class="at">2010-2019</span><span class="st">`</span>,<span class="at">paired=</span><span class="cn">TRUE</span>,<span class="at">alternative_m =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb178-6"><a href="cancer-epidemiology.html#cb178-6" tabindex="-1"></a>p</span>
<span id="cb178-7"><a href="cancer-epidemiology.html#cb178-7" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb178-8"><a href="cancer-epidemiology.html#cb178-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb178-9"><a href="cancer-epidemiology.html#cb178-9" tabindex="-1"></a><span class="co">#&gt;  Paired t-test</span></span>
<span id="cb178-10"><a href="cancer-epidemiology.html#cb178-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb178-11"><a href="cancer-epidemiology.html#cb178-11" tabindex="-1"></a><span class="co">#&gt; data:  HKCancer_mort_inc_year_m$`1990-1999` and HKCancer_mort_inc_year_m$`2000-2009`</span></span>
<span id="cb178-12"><a href="cancer-epidemiology.html#cb178-12" tabindex="-1"></a><span class="co">#&gt; t = 0.79695, df = 33, p-value = 0.4312</span></span>
<span id="cb178-13"><a href="cancer-epidemiology.html#cb178-13" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true mean difference is not equal to 0</span></span>
<span id="cb178-14"><a href="cancer-epidemiology.html#cb178-14" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb178-15"><a href="cancer-epidemiology.html#cb178-15" tabindex="-1"></a><span class="co">#&gt;  -0.01415536  0.03238636</span></span>
<span id="cb178-16"><a href="cancer-epidemiology.html#cb178-16" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb178-17"><a href="cancer-epidemiology.html#cb178-17" tabindex="-1"></a><span class="co">#&gt; mean difference </span></span>
<span id="cb178-18"><a href="cancer-epidemiology.html#cb178-18" tabindex="-1"></a><span class="co">#&gt;     0.009115498 </span></span>
<span id="cb178-19"><a href="cancer-epidemiology.html#cb178-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb178-20"><a href="cancer-epidemiology.html#cb178-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb178-21"><a href="cancer-epidemiology.html#cb178-21" tabindex="-1"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb178-22"><a href="cancer-epidemiology.html#cb178-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb178-23"><a href="cancer-epidemiology.html#cb178-23" tabindex="-1"></a><span class="co">#&gt;  Paired t-test</span></span>
<span id="cb178-24"><a href="cancer-epidemiology.html#cb178-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb178-25"><a href="cancer-epidemiology.html#cb178-25" tabindex="-1"></a><span class="co">#&gt; data:  HKCancer_mort_inc_year_m$`1990-1999` and HKCancer_mort_inc_year_m$`2010-2019`</span></span>
<span id="cb178-26"><a href="cancer-epidemiology.html#cb178-26" tabindex="-1"></a><span class="co">#&gt; t = 2.1861, df = 33, p-value = 0.036</span></span>
<span id="cb178-27"><a href="cancer-epidemiology.html#cb178-27" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true mean difference is not equal to 0</span></span>
<span id="cb178-28"><a href="cancer-epidemiology.html#cb178-28" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb178-29"><a href="cancer-epidemiology.html#cb178-29" tabindex="-1"></a><span class="co">#&gt;  0.002055217 0.057209924</span></span>
<span id="cb178-30"><a href="cancer-epidemiology.html#cb178-30" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb178-31"><a href="cancer-epidemiology.html#cb178-31" tabindex="-1"></a><span class="co">#&gt; mean difference </span></span>
<span id="cb178-32"><a href="cancer-epidemiology.html#cb178-32" tabindex="-1"></a><span class="co">#&gt;      0.02963257 </span></span>
<span id="cb178-33"><a href="cancer-epidemiology.html#cb178-33" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb178-34"><a href="cancer-epidemiology.html#cb178-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb178-35"><a href="cancer-epidemiology.html#cb178-35" tabindex="-1"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb178-36"><a href="cancer-epidemiology.html#cb178-36" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb178-37"><a href="cancer-epidemiology.html#cb178-37" tabindex="-1"></a><span class="co">#&gt;  Paired t-test</span></span>
<span id="cb178-38"><a href="cancer-epidemiology.html#cb178-38" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb178-39"><a href="cancer-epidemiology.html#cb178-39" tabindex="-1"></a><span class="co">#&gt; data:  HKCancer_mort_inc_year_m$`2000-2009` and HKCancer_mort_inc_year_m$`2010-2019`</span></span>
<span id="cb178-40"><a href="cancer-epidemiology.html#cb178-40" tabindex="-1"></a><span class="co">#&gt; t = 1.5413, df = 35, p-value = 0.1322</span></span>
<span id="cb178-41"><a href="cancer-epidemiology.html#cb178-41" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true mean difference is not equal to 0</span></span>
<span id="cb178-42"><a href="cancer-epidemiology.html#cb178-42" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb178-43"><a href="cancer-epidemiology.html#cb178-43" tabindex="-1"></a><span class="co">#&gt;  -0.005438019  0.039734021</span></span>
<span id="cb178-44"><a href="cancer-epidemiology.html#cb178-44" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb178-45"><a href="cancer-epidemiology.html#cb178-45" tabindex="-1"></a><span class="co">#&gt; mean difference </span></span>
<span id="cb178-46"><a href="cancer-epidemiology.html#cb178-46" tabindex="-1"></a><span class="co">#&gt;        0.017148</span></span></code></pre></div>
</div>
<div id="e.-childhood-versus-elderly-cancers" class="section level3 hasAnchor" number="9.3.6">
<h3><span class="header-section-number">9.3.6</span> 3e. Childhood versus elderly cancers<a href="cancer-epidemiology.html#e.-childhood-versus-elderly-cancers" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Although it is clear that the incidence of cancer is typically higher in the elderly, some cancers affect children as well. What cancer types disproportionate affect children? For each cancer type, compare the proportion of 0-19 versus 65+ incidence against the 0-19 versus 65+ incidence for all other cancer types.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="cancer-epidemiology.html#cb179-1" tabindex="-1"></a><span class="co"># Examine the proportion of childhood </span></span>
<span id="cb179-2"><a href="cancer-epidemiology.html#cb179-2" tabindex="-1"></a></span>
<span id="cb179-3"><a href="cancer-epidemiology.html#cb179-3" tabindex="-1"></a>HKCancer_inc <span class="ot">&lt;-</span> HKCancer[HKCancer<span class="sc">$</span>Type<span class="sc">==</span><span class="st">&#39;incidence&#39;</span>,]</span>
<span id="cb179-4"><a href="cancer-epidemiology.html#cb179-4" tabindex="-1"></a>HKCancer_inc_age_sum <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(HKCancer_inc[,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)],<span class="fu">list</span>(HKCancer_inc<span class="sc">$</span>Age),<span class="at">FUN=</span>sum)</span>
<span id="cb179-5"><a href="cancer-epidemiology.html#cb179-5" tabindex="-1"></a>HKCancer_inc_age_sum<span class="sc">$</span>Total<span class="ot">&lt;-</span> <span class="fu">rowSums</span>(HKCancer_inc_age_sum[,<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb179-6"><a href="cancer-epidemiology.html#cb179-6" tabindex="-1"></a>HKCancer_inc_age_sum_csq <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(<span class="at">cancer=</span><span class="fu">names</span>(HKCancer_inc_age_sum[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(HKCancer_inc_age_sum)]))</span>
<span id="cb179-7"><a href="cancer-epidemiology.html#cb179-7" tabindex="-1"></a></span>
<span id="cb179-8"><a href="cancer-epidemiology.html#cb179-8" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb179-9"><a href="cancer-epidemiology.html#cb179-9" tabindex="-1"></a>ratio <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb179-10"><a href="cancer-epidemiology.html#cb179-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(<span class="fu">ncol</span>(HKCancer_inc_age_sum))){</span>
<span id="cb179-11"><a href="cancer-epidemiology.html#cb179-11" tabindex="-1"></a>  val <span class="ot">=</span> <span class="fu">Map</span>(<span class="st">&#39;-&#39;</span>,HKCancer_inc_age_sum<span class="sc">$</span>Total,HKCancer_inc_age_sum[,i])</span>
<span id="cb179-12"><a href="cancer-epidemiology.html#cb179-12" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">cancer=</span>HKCancer_inc_age_sum[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>),i], <span class="at">other =</span><span class="fu">c</span>(val[[<span class="dv">1</span>]],val[[<span class="dv">2</span>]]))</span>
<span id="cb179-13"><a href="cancer-epidemiology.html#cb179-13" tabindex="-1"></a>  pval <span class="ot">&lt;-</span> <span class="fu">append</span>(pval,<span class="fu">fisher.test</span>(dat)<span class="sc">$</span>p.val)</span>
<span id="cb179-14"><a href="cancer-epidemiology.html#cb179-14" tabindex="-1"></a>  ratio<span class="ot">&lt;-</span> <span class="fu">append</span>(ratio,<span class="fu">log</span>(<span class="fu">as.double</span>(dat[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">+</span><span class="fl">0.1</span>)<span class="sc">/</span><span class="fu">as.double</span>(dat[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">+</span><span class="fl">0.1</span>)))</span>
<span id="cb179-15"><a href="cancer-epidemiology.html#cb179-15" tabindex="-1"></a>}</span>
<span id="cb179-16"><a href="cancer-epidemiology.html#cb179-16" tabindex="-1"></a>HKCancer_inc_age_sum_csq<span class="sc">$</span>pval <span class="ot">&lt;-</span> pval</span>
<span id="cb179-17"><a href="cancer-epidemiology.html#cb179-17" tabindex="-1"></a>HKCancer_inc_age_sum_csq<span class="sc">$</span>ratio <span class="ot">&lt;-</span> ratio </span>
<span id="cb179-18"><a href="cancer-epidemiology.html#cb179-18" tabindex="-1"></a></span>
<span id="cb179-19"><a href="cancer-epidemiology.html#cb179-19" tabindex="-1"></a>plot_child<span class="ot">&lt;-</span><span class="fu">ggplot</span>(HKCancer_inc_age_sum_csq[<span class="sc">-</span><span class="dv">37</span>,],<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(cancer,<span class="sc">-</span><span class="fu">as.numeric</span>(ratio)),<span class="at">y=</span><span class="fu">as.numeric</span>(ratio)),<span class="at">fill=</span>cancer)<span class="sc">+</span></span>
<span id="cb179-20"><a href="cancer-epidemiology.html#cb179-20" tabindex="-1"></a>       <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">fill=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb179-21"><a href="cancer-epidemiology.html#cb179-21" tabindex="-1"></a>       <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="sc">-</span><span class="fl">4.12132318942113</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb179-22"><a href="cancer-epidemiology.html#cb179-22" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb179-23"><a href="cancer-epidemiology.html#cb179-23" tabindex="-1"></a>       <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb179-24"><a href="cancer-epidemiology.html#cb179-24" tabindex="-1"></a>       <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Spectral&quot;</span>)<span class="sc">+</span></span>
<span id="cb179-25"><a href="cancer-epidemiology.html#cb179-25" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb179-26"><a href="cancer-epidemiology.html#cb179-26" tabindex="-1"></a>       <span class="co">#theme(text = element_text(size = 10))+</span></span>
<span id="cb179-27"><a href="cancer-epidemiology.html#cb179-27" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb179-28"><a href="cancer-epidemiology.html#cb179-28" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb179-29"><a href="cancer-epidemiology.html#cb179-29" tabindex="-1"></a>       <span class="fu">ylab</span>(<span class="st">&quot;log((child+0.1)/(elderly+0.1)&quot;</span>)</span>
<span id="cb179-30"><a href="cancer-epidemiology.html#cb179-30" tabindex="-1"></a>plot_child</span></code></pre></div>
<p><img src="BMDatSci_files/figure-html/childhood%20versus%20elderly-1.png" width="672" /></p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="cancer-epidemiology.html#cb180-1" tabindex="-1"></a>HKCancer_inc_age_sum_csq</span>
<span id="cb180-2"><a href="cancer-epidemiology.html#cb180-2" tabindex="-1"></a><span class="co">#&gt;                  cancer          pval       ratio</span></span>
<span id="cb180-3"><a href="cancer-epidemiology.html#cb180-3" tabindex="-1"></a><span class="co">#&gt; 1               Biliary  1.21618e-216   -11.17481</span></span>
<span id="cb180-4"><a href="cancer-epidemiology.html#cb180-4" tabindex="-1"></a><span class="co">#&gt; 2               Bladder 9.601084e-314   -6.711128</span></span>
<span id="cb180-5"><a href="cancer-epidemiology.html#cb180-5" tabindex="-1"></a><span class="co">#&gt; 3                 Brain             0   -0.615666</span></span>
<span id="cb180-6"><a href="cancer-epidemiology.html#cb180-6" tabindex="-1"></a><span class="co">#&gt; 4                Breast             0   -7.519824</span></span>
<span id="cb180-7"><a href="cancer-epidemiology.html#cb180-7" tabindex="-1"></a><span class="co">#&gt; 5                Cervix 1.635299e-126   -6.925188</span></span>
<span id="cb180-8"><a href="cancer-epidemiology.html#cb180-8" tabindex="-1"></a><span class="co">#&gt; 6            Colorectum             0   -7.531208</span></span>
<span id="cb180-9"><a href="cancer-epidemiology.html#cb180-9" tabindex="-1"></a><span class="co">#&gt; 7                   Eye 2.085337e-112   0.5039276</span></span>
<span id="cb180-10"><a href="cancer-epidemiology.html#cb180-10" tabindex="-1"></a><span class="co">#&gt; 8      Hodgkin.lymphoma  3.658856e-81  -0.6227962</span></span>
<span id="cb180-11"><a href="cancer-epidemiology.html#cb180-11" tabindex="-1"></a><span class="co">#&gt; 9                Kaposi       0.41662   -5.525453</span></span>
<span id="cb180-12"><a href="cancer-epidemiology.html#cb180-12" tabindex="-1"></a><span class="co">#&gt; 10               Kidney  1.560619e-71   -3.882371</span></span>
<span id="cb180-13"><a href="cancer-epidemiology.html#cb180-13" tabindex="-1"></a><span class="co">#&gt; 11               Larynx 1.963055e-113   -8.129416</span></span>
<span id="cb180-14"><a href="cancer-epidemiology.html#cb180-14" tabindex="-1"></a><span class="co">#&gt; 12            Leukaemia             0   -1.043172</span></span>
<span id="cb180-15"><a href="cancer-epidemiology.html#cb180-15" tabindex="-1"></a><span class="co">#&gt; 13                Liver             0   -4.909033</span></span>
<span id="cb180-16"><a href="cancer-epidemiology.html#cb180-16" tabindex="-1"></a><span class="co">#&gt; 14                 Lung             0   -8.191896</span></span>
<span id="cb180-17"><a href="cancer-epidemiology.html#cb180-17" tabindex="-1"></a><span class="co">#&gt; 15             Melanoma  6.246412e-15   -4.324192</span></span>
<span id="cb180-18"><a href="cancer-epidemiology.html#cb180-18" tabindex="-1"></a><span class="co">#&gt; 16         Mesothelioma  5.396388e-09   -7.897668</span></span>
<span id="cb180-19"><a href="cancer-epidemiology.html#cb180-19" tabindex="-1"></a><span class="co">#&gt; 17     Multiple.myeloma 6.126613e-106   -7.062026</span></span>
<span id="cb180-20"><a href="cancer-epidemiology.html#cb180-20" tabindex="-1"></a><span class="co">#&gt; 18                Nasal  0.0001285609   -3.286427</span></span>
<span id="cb180-21"><a href="cancer-epidemiology.html#cb180-21" tabindex="-1"></a><span class="co">#&gt; 19          Nasopharynx  4.628193e-74    -3.95948</span></span>
<span id="cb180-22"><a href="cancer-epidemiology.html#cb180-22" tabindex="-1"></a><span class="co">#&gt; 20 Non.Hodgkin.lymphoma  4.513518e-11   -2.940272</span></span>
<span id="cb180-23"><a href="cancer-epidemiology.html#cb180-23" tabindex="-1"></a><span class="co">#&gt; 21    Non.melanoma.skin             0   -6.315107</span></span>
<span id="cb180-24"><a href="cancer-epidemiology.html#cb180-24" tabindex="-1"></a><span class="co">#&gt; 22           Oesophagus 1.377432e-251   -8.943186</span></span>
<span id="cb180-25"><a href="cancer-epidemiology.html#cb180-25" tabindex="-1"></a><span class="co">#&gt; 23                 Oral 5.100139e-108   -4.379029</span></span>
<span id="cb180-26"><a href="cancer-epidemiology.html#cb180-26" tabindex="-1"></a><span class="co">#&gt; 24                Ovary  0.0002847234    -2.34054</span></span>
<span id="cb180-27"><a href="cancer-epidemiology.html#cb180-27" tabindex="-1"></a><span class="co">#&gt; 25             Pancreas  3.11451e-246   -6.690686</span></span>
<span id="cb180-28"><a href="cancer-epidemiology.html#cb180-28" tabindex="-1"></a><span class="co">#&gt; 26                Penis  3.023792e-18   -5.753479</span></span>
<span id="cb180-29"><a href="cancer-epidemiology.html#cb180-29" tabindex="-1"></a><span class="co">#&gt; 27             Placenta    0.07013259    2.397895</span></span>
<span id="cb180-30"><a href="cancer-epidemiology.html#cb180-30" tabindex="-1"></a><span class="co">#&gt; 28             Prostate             0   -10.08778</span></span>
<span id="cb180-31"><a href="cancer-epidemiology.html#cb180-31" tabindex="-1"></a><span class="co">#&gt; 29              Sarcoma 9.774701e-213   -1.028899</span></span>
<span id="cb180-32"><a href="cancer-epidemiology.html#cb180-32" tabindex="-1"></a><span class="co">#&gt; 30      Small.intestine  1.479593e-31   -5.916202</span></span>
<span id="cb180-33"><a href="cancer-epidemiology.html#cb180-33" tabindex="-1"></a><span class="co">#&gt; 31              Stomach             0   -7.137096</span></span>
<span id="cb180-34"><a href="cancer-epidemiology.html#cb180-34" tabindex="-1"></a><span class="co">#&gt; 32               Testis  1.871184e-97 -0.09472556</span></span>
<span id="cb180-35"><a href="cancer-epidemiology.html#cb180-35" tabindex="-1"></a><span class="co">#&gt; 33               Thymus  6.748934e-06   -1.915502</span></span>
<span id="cb180-36"><a href="cancer-epidemiology.html#cb180-36" tabindex="-1"></a><span class="co">#&gt; 34              Thyroid  7.821825e-09   -2.194891</span></span>
<span id="cb180-37"><a href="cancer-epidemiology.html#cb180-37" tabindex="-1"></a><span class="co">#&gt; 35               Uterus 1.457974e-105   -6.262217</span></span>
<span id="cb180-38"><a href="cancer-epidemiology.html#cb180-38" tabindex="-1"></a><span class="co">#&gt; 36                Vulva  1.521831e-27   -5.552298</span></span>
<span id="cb180-39"><a href="cancer-epidemiology.html#cb180-39" tabindex="-1"></a><span class="co">#&gt; 37                Total             1   -4.121323</span></span></code></pre></div>
</div>
</div>
<div id="existing-cancer-funding-and-publication-data" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> 4. Existing cancer funding and publication data<a href="cancer-epidemiology.html#existing-cancer-funding-and-publication-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Hong Kong government established in Health and Medical Research Fund (HMRF) in 2011 to specifically provide research funding for health and medical research in Hong Kong. Since 2016 over 370 projects in the category of Cancer has been funded for a total of ~$400 M dollars. A list of all funded projects can be found on the Health Bureau <a href="https://rfs1.healthbureau.gov.hk/search/#/fundedsearch/basicsearch?lang=en">webpage</a>. You would like to use this data to see if there is any association between previous project funding and the epidemiology of cancers in Hong Kong.</p>
<p>We can also do a similar thing with publications and ask if the research publications in Hong Kong have been aligned with the incidence and mortality. We can obtain this data from PubMed using the following terms: <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%28%22Hong+Kong%22%5BAffiliation%5D%29+AND+%28neoplasms%5BMeSH+Terms%5D%29">(“Hong Kong”[Affiliation]) AND (neoplasms[MeSH Terms])</a></p>
<p>The data has been predownloaded as the Pubmed API via R is a bit slow.</p>
<p><u>Discussion points:</u></p>
<ul>
<li>Why has research publications increased dramatically in recent years? Is there something unsual with the dataset?</li>
<li>What are the main cancer types being researched in Hong Kong?</li>
<li>Is there any correlation between funding and cancer incidence and mortality?</li>
</ul>
<div id="download-hmrf-grants-and-pubmed-data" class="section level3 hasAnchor" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> Download HMRF grants and Pubmed data<a href="cancer-epidemiology.html#download-hmrf-grants-and-pubmed-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="cancer-epidemiology.html#cb181-1" tabindex="-1"></a></span>
<span id="cb181-2"><a href="cancer-epidemiology.html#cb181-2" tabindex="-1"></a>HMRF<span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">&quot;https://github.com/StatBiomed/BMDS-book/raw/main/notebooks/module5-epidemi/HMRF_cancer_grants.txt&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactor=</span><span class="cn">FALSE</span>, <span class="at">check.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb181-3"><a href="cancer-epidemiology.html#cb181-3" tabindex="-1"></a><span class="co">#HMRF</span></span>
<span id="cb181-4"><a href="cancer-epidemiology.html#cb181-4" tabindex="-1"></a></span>
<span id="cb181-5"><a href="cancer-epidemiology.html#cb181-5" tabindex="-1"></a>pubmed<span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">&quot;https://github.com/StatBiomed/BMDS-book/raw/main/notebooks/module5-epidemi/pubmed__neoplasm_hongkong.txt&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactor=</span><span class="cn">FALSE</span>, <span class="at">check.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb181-6"><a href="cancer-epidemiology.html#cb181-6" tabindex="-1"></a><span class="co">#pubmed</span></span>
<span id="cb181-7"><a href="cancer-epidemiology.html#cb181-7" tabindex="-1"></a></span>
<span id="cb181-8"><a href="cancer-epidemiology.html#cb181-8" tabindex="-1"></a><span class="fu">hist</span>(pubmed<span class="sc">$</span>Publication.Year)</span></code></pre></div>
<p><img src="BMDatSci_files/figure-html/load%20HMRF-1.png" width="672" /></p>
</div>
<div id="make-word-cloud-for-grants" class="section level3 hasAnchor" number="9.4.2">
<h3><span class="header-section-number">9.4.2</span> Make word cloud for grants<a href="cancer-epidemiology.html#make-word-cloud-for-grants" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- ```{r wordcloud grants, fig.height=8, fig.width=10} -->
<!-- if (!require("ggwordcloud")) install.packages("ggwordcloud") -->
<!-- if (!require("tm")) install.packages("tm") -->
<!-- if (!require("dplyr")) install.packages("dplyr") -->
<!-- if (!require("RColorBrewer")) install.packages("RColorBrewer") -->
<!-- library(ggwordcloud) -->
<!-- library(tm) -->
<!-- library(dplyr) -->
<!-- library(RColorBrewer) -->
<!-- #Create a vector containing only the text -->
<!-- gtext <- HMRF$Project.Title -->
<!-- # Create a corpus   -->
<!-- gdocs <- Corpus(VectorSource(gtext)) -->
<!-- gdocs <- gdocs %>% -->
<!--   tm_map(removePunctuation) %>% -->
<!--   tm_map(stripWhitespace) -->
<!-- gdocs <- tm_map(gdocs, content_transformer(tolower)) -->
<!-- gdocs <- tm_map(gdocs, removeWords, stopwords("english")) -->
<!-- gdtm <- TermDocumentMatrix(gdocs)  -->
<!-- gmatrix <- as.matrix(gdtm)  -->
<!-- gwords <- sort(rowSums(gmatrix),decreasing=TRUE)  -->
<!-- gdf <- data.frame(word = names(gwords),freq=gwords) -->
<!-- set.seed(1235) # for reproducibility  -->
<!-- gp<-ggwordcloud(words = gdf$word, freq = gdf$freq, min.freq = 1,max.words=200, random.order=FALSE, rot.per=0.35,            colors=brewer.pal(8, "Dark2")) -->
<!-- #gp -->
<!-- #Create a vector containing only the text -->
<!-- pmtext <- pubmed$Title -->
<!-- # Create a corpus   -->
<!-- pmdocs <- Corpus(VectorSource(pmtext)) -->
<!-- pmdocs <- pmdocs %>% -->
<!--   tm_map(removePunctuation) %>% -->
<!--   tm_map(stripWhitespace) -->
<!-- pmdocs <- tm_map(pmdocs, content_transformer(tolower)) -->
<!-- pmdocs <- tm_map(pmdocs, removeWords, stopwords("english")) -->
<!-- pmdtm <- TermDocumentMatrix(pmdocs)  -->
<!-- pmmatrix <- as.matrix(pmdtm)  -->
<!-- pmwords <- sort(rowSums(pmmatrix),decreasing=TRUE)  -->
<!-- pmdf <- data.frame(word = names(pmwords),freq=pmwords) -->
<!-- set.seed(1235) # for reproducibility  -->
<!-- pm<-ggwordcloud(words = pmdf$word, freq = pmdf$freq, min.freq = 1,max.words=200, random.order=FALSE, rot.per=0.35,            colors=brewer.pal(8, "Dark2")) -->
<!-- grid.arrange(arrangeGrob(pm, top = 'Pubmed'),arrangeGrob(gp, top = 'Grants'),nrow=2,heights=c(6,6)) -->
<!-- ``` -->
</div>
<div id="make-compare-grant-funding-with-incidence-and-mortality" class="section level3 hasAnchor" number="9.4.3">
<h3><span class="header-section-number">9.4.3</span> Make compare grant funding with incidence and mortality<a href="cancer-epidemiology.html#make-compare-grant-funding-with-incidence-and-mortality" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="cancer-epidemiology.html#cb182-1" tabindex="-1"></a></span>
<span id="cb182-2"><a href="cancer-epidemiology.html#cb182-2" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;ggrepel&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;ggrepel&quot;</span>)</span>
<span id="cb182-3"><a href="cancer-epidemiology.html#cb182-3" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;ggplot2&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;gglot2&quot;</span>)</span>
<span id="cb182-4"><a href="cancer-epidemiology.html#cb182-4" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;gridExtra&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;gridExtra&quot;</span>)</span>
<span id="cb182-5"><a href="cancer-epidemiology.html#cb182-5" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb182-6"><a href="cancer-epidemiology.html#cb182-6" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb182-7"><a href="cancer-epidemiology.html#cb182-7" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb182-8"><a href="cancer-epidemiology.html#cb182-8" tabindex="-1"></a></span>
<span id="cb182-9"><a href="cancer-epidemiology.html#cb182-9" tabindex="-1"></a></span>
<span id="cb182-10"><a href="cancer-epidemiology.html#cb182-10" tabindex="-1"></a>grantpmsum<span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">&quot;https://github.com/StatBiomed/BMDS-book/raw/main/notebooks/module5-epidemi/Grants_pubmed_summary.txt&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactor=</span><span class="cn">FALSE</span>, <span class="at">check.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb182-11"><a href="cancer-epidemiology.html#cb182-11" tabindex="-1"></a>grantpmsum</span>
<span id="cb182-12"><a href="cancer-epidemiology.html#cb182-12" tabindex="-1"></a><span class="co">#&gt;                  Cancer Grants Pubmed</span></span>
<span id="cb182-13"><a href="cancer-epidemiology.html#cb182-13" tabindex="-1"></a><span class="co">#&gt; 1               Biliary      0     72</span></span>
<span id="cb182-14"><a href="cancer-epidemiology.html#cb182-14" tabindex="-1"></a><span class="co">#&gt; 2               Bladder      0    141</span></span>
<span id="cb182-15"><a href="cancer-epidemiology.html#cb182-15" tabindex="-1"></a><span class="co">#&gt; 3                 Brain      2    294</span></span>
<span id="cb182-16"><a href="cancer-epidemiology.html#cb182-16" tabindex="-1"></a><span class="co">#&gt; 4                Breast     34   1147</span></span>
<span id="cb182-17"><a href="cancer-epidemiology.html#cb182-17" tabindex="-1"></a><span class="co">#&gt; 5                Cervix      9    408</span></span>
<span id="cb182-18"><a href="cancer-epidemiology.html#cb182-18" tabindex="-1"></a><span class="co">#&gt; 6            Colorectum     40    857</span></span>
<span id="cb182-19"><a href="cancer-epidemiology.html#cb182-19" tabindex="-1"></a><span class="co">#&gt; 7                   Eye      2     27</span></span>
<span id="cb182-20"><a href="cancer-epidemiology.html#cb182-20" tabindex="-1"></a><span class="co">#&gt; 8      Hodgkin lymphoma      0     21</span></span>
<span id="cb182-21"><a href="cancer-epidemiology.html#cb182-21" tabindex="-1"></a><span class="co">#&gt; 9                Kaposi      0      6</span></span>
<span id="cb182-22"><a href="cancer-epidemiology.html#cb182-22" tabindex="-1"></a><span class="co">#&gt; 10               Kidney      0    133</span></span>
<span id="cb182-23"><a href="cancer-epidemiology.html#cb182-23" tabindex="-1"></a><span class="co">#&gt; 11               Larynx      0      8</span></span>
<span id="cb182-24"><a href="cancer-epidemiology.html#cb182-24" tabindex="-1"></a><span class="co">#&gt; 12            Leukaemia     18    515</span></span>
<span id="cb182-25"><a href="cancer-epidemiology.html#cb182-25" tabindex="-1"></a><span class="co">#&gt; 13                Liver     97   2077</span></span>
<span id="cb182-26"><a href="cancer-epidemiology.html#cb182-26" tabindex="-1"></a><span class="co">#&gt; 14                 Lung     22    773</span></span>
<span id="cb182-27"><a href="cancer-epidemiology.html#cb182-27" tabindex="-1"></a><span class="co">#&gt; 15             Melanoma      0     99</span></span>
<span id="cb182-28"><a href="cancer-epidemiology.html#cb182-28" tabindex="-1"></a><span class="co">#&gt; 16         Mesothelioma      6     58</span></span>
<span id="cb182-29"><a href="cancer-epidemiology.html#cb182-29" tabindex="-1"></a><span class="co">#&gt; 17     Multiple myeloma      0    104</span></span>
<span id="cb182-30"><a href="cancer-epidemiology.html#cb182-30" tabindex="-1"></a><span class="co">#&gt; 18                Nasal      0     14</span></span>
<span id="cb182-31"><a href="cancer-epidemiology.html#cb182-31" tabindex="-1"></a><span class="co">#&gt; 19          Nasopharynx     24   1113</span></span>
<span id="cb182-32"><a href="cancer-epidemiology.html#cb182-32" tabindex="-1"></a><span class="co">#&gt; 20 Non-Hodgkin lymphoma      0     55</span></span>
<span id="cb182-33"><a href="cancer-epidemiology.html#cb182-33" tabindex="-1"></a><span class="co">#&gt; 21                 Skin      0     32</span></span>
<span id="cb182-34"><a href="cancer-epidemiology.html#cb182-34" tabindex="-1"></a><span class="co">#&gt; 22           Oesophagus      7    404</span></span>
<span id="cb182-35"><a href="cancer-epidemiology.html#cb182-35" tabindex="-1"></a><span class="co">#&gt; 23                 Oral      5    229</span></span>
<span id="cb182-36"><a href="cancer-epidemiology.html#cb182-36" tabindex="-1"></a><span class="co">#&gt; 24                Ovary     14    354</span></span>
<span id="cb182-37"><a href="cancer-epidemiology.html#cb182-37" tabindex="-1"></a><span class="co">#&gt; 25             Pancreas      2    141</span></span>
<span id="cb182-38"><a href="cancer-epidemiology.html#cb182-38" tabindex="-1"></a><span class="co">#&gt; 26                Penis      0      7</span></span>
<span id="cb182-39"><a href="cancer-epidemiology.html#cb182-39" tabindex="-1"></a><span class="co">#&gt; 27             Placenta      0      9</span></span>
<span id="cb182-40"><a href="cancer-epidemiology.html#cb182-40" tabindex="-1"></a><span class="co">#&gt; 28             Prostate      6    322</span></span>
<span id="cb182-41"><a href="cancer-epidemiology.html#cb182-41" tabindex="-1"></a><span class="co">#&gt; 29              Sarcoma      2    216</span></span>
<span id="cb182-42"><a href="cancer-epidemiology.html#cb182-42" tabindex="-1"></a><span class="co">#&gt; 30      Small intestine      0     11</span></span>
<span id="cb182-43"><a href="cancer-epidemiology.html#cb182-43" tabindex="-1"></a><span class="co">#&gt; 31              Stomach      5    455</span></span>
<span id="cb182-44"><a href="cancer-epidemiology.html#cb182-44" tabindex="-1"></a><span class="co">#&gt; 32               Testis      0     18</span></span>
<span id="cb182-45"><a href="cancer-epidemiology.html#cb182-45" tabindex="-1"></a><span class="co">#&gt; 33               Thymus      0      3</span></span>
<span id="cb182-46"><a href="cancer-epidemiology.html#cb182-46" tabindex="-1"></a><span class="co">#&gt; 34              Thyroid      2    231</span></span>
<span id="cb182-47"><a href="cancer-epidemiology.html#cb182-47" tabindex="-1"></a><span class="co">#&gt; 35               Uterus      0     72</span></span>
<span id="cb182-48"><a href="cancer-epidemiology.html#cb182-48" tabindex="-1"></a><span class="co">#&gt; 36                Vulva      0      8</span></span>
<span id="cb182-49"><a href="cancer-epidemiology.html#cb182-49" tabindex="-1"></a></span>
<span id="cb182-50"><a href="cancer-epidemiology.html#cb182-50" tabindex="-1"></a>HKCancer_inc <span class="ot">&lt;-</span> HKCancer[HKCancer<span class="sc">$</span>Type<span class="sc">==</span><span class="st">&#39;incidence&#39;</span>,]</span>
<span id="cb182-51"><a href="cancer-epidemiology.html#cb182-51" tabindex="-1"></a>HKCancer_inc_sum <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">incidence=</span><span class="fu">colSums</span>(HKCancer_inc[,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)]))</span>
<span id="cb182-52"><a href="cancer-epidemiology.html#cb182-52" tabindex="-1"></a></span>
<span id="cb182-53"><a href="cancer-epidemiology.html#cb182-53" tabindex="-1"></a>HKCancer_mort <span class="ot">&lt;-</span> HKCancer[HKCancer<span class="sc">$</span>Type<span class="sc">==</span><span class="st">&#39;mortality&#39;</span>,]</span>
<span id="cb182-54"><a href="cancer-epidemiology.html#cb182-54" tabindex="-1"></a>HKCancer_mort_sum <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mortality=</span><span class="fu">colSums</span>(HKCancer_inc[,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)]))</span>
<span id="cb182-55"><a href="cancer-epidemiology.html#cb182-55" tabindex="-1"></a></span>
<span id="cb182-56"><a href="cancer-epidemiology.html#cb182-56" tabindex="-1"></a>HKCancer_compare <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">cancer=</span>grantpmsum<span class="sc">$</span>Cancer, <span class="at">grants=</span>grantpmsum<span class="sc">$</span>Grants, <span class="at">pubmed=</span>grantpmsum<span class="sc">$</span>Pubmed, <span class="at">incidence=</span><span class="fu">colSums</span>(HKCancer_inc[,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)]), <span class="at">mortality=</span><span class="fu">colSums</span>(HKCancer_mort[,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)]))</span>
<span id="cb182-57"><a href="cancer-epidemiology.html#cb182-57" tabindex="-1"></a></span>
<span id="cb182-58"><a href="cancer-epidemiology.html#cb182-58" tabindex="-1"></a>gp<span class="ot">&lt;-</span><span class="fu">ggplot</span>(HKCancer_compare, <span class="fu">aes</span>(<span class="at">y=</span>grants, <span class="at">x=</span>pubmed)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">scale_color_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span>  <span class="fu">geom_label_repel</span>(<span class="at">data=</span>HKCancer_compare, <span class="fu">aes</span>(<span class="at">label=</span>cancer),  <span class="at">nudge_x =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="fl">3.5</span>,<span class="at">label.size =</span> <span class="cn">NA</span> ,<span class="at">min.segment.length =</span><span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">&#39;lines&#39;</span>), <span class="at">max.overlaps =</span> <span class="dv">45</span>, <span class="at">box.padding =</span> <span class="fl">0.4</span>) <span class="sc">+</span> <span class="fu">stat_cor</span>(<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>, <span class="at">label.x =</span> <span class="dv">3</span>, <span class="at">label.y =</span> <span class="dv">90</span>)</span>
<span id="cb182-59"><a href="cancer-epidemiology.html#cb182-59" tabindex="-1"></a></span>
<span id="cb182-60"><a href="cancer-epidemiology.html#cb182-60" tabindex="-1"></a>pinc<span class="ot">&lt;-</span><span class="fu">ggplot</span>(HKCancer_compare, <span class="fu">aes</span>(<span class="at">y=</span>pubmed, <span class="at">x=</span>incidence)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">scale_color_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span>  <span class="fu">geom_label_repel</span>(<span class="at">data=</span>HKCancer_compare, <span class="fu">aes</span>(<span class="at">label=</span>cancer),  <span class="at">nudge_x =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="fl">3.5</span>,<span class="at">label.size =</span> <span class="cn">NA</span> ,<span class="at">min.segment.length =</span><span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">&#39;lines&#39;</span>), <span class="at">max.overlaps =</span> <span class="dv">15</span>, <span class="at">box.padding =</span> <span class="fl">0.5</span>)<span class="sc">+</span> <span class="fu">stat_cor</span>(<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>, <span class="at">label.x =</span> <span class="dv">40000</span>, <span class="at">label.y =</span> <span class="dv">0</span>)</span>
<span id="cb182-61"><a href="cancer-epidemiology.html#cb182-61" tabindex="-1"></a></span>
<span id="cb182-62"><a href="cancer-epidemiology.html#cb182-62" tabindex="-1"></a>pmor<span class="ot">&lt;-</span><span class="fu">ggplot</span>(HKCancer_compare, <span class="fu">aes</span>(<span class="at">y=</span>pubmed, <span class="at">x=</span>mortality)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">scale_color_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span>  <span class="fu">geom_label_repel</span>(<span class="at">data=</span>HKCancer_compare, <span class="fu">aes</span>(<span class="at">label=</span>cancer),  <span class="at">nudge_x =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="fl">3.5</span>,<span class="at">label.size =</span> <span class="cn">NA</span> ,<span class="at">min.segment.length =</span><span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">&#39;lines&#39;</span>), <span class="at">max.overlaps =</span> <span class="dv">15</span>, <span class="at">box.padding =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">stat_cor</span>(<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>, <span class="at">label.x =</span> <span class="dv">40000</span>, <span class="at">label.y =</span> <span class="dv">0</span>)</span>
<span id="cb182-63"><a href="cancer-epidemiology.html#cb182-63" tabindex="-1"></a></span>
<span id="cb182-64"><a href="cancer-epidemiology.html#cb182-64" tabindex="-1"></a></span>
<span id="cb182-65"><a href="cancer-epidemiology.html#cb182-65" tabindex="-1"></a>ginc<span class="ot">&lt;-</span><span class="fu">ggplot</span>(HKCancer_compare, <span class="fu">aes</span>(<span class="at">y=</span>grants, <span class="at">x=</span>incidence)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">scale_color_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span>  <span class="fu">geom_label_repel</span>(<span class="at">data=</span>HKCancer_compare, <span class="fu">aes</span>(<span class="at">label=</span>cancer),  <span class="at">nudge_x =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="fl">3.5</span>,<span class="at">label.size =</span> <span class="cn">NA</span> ,<span class="at">min.segment.length =</span><span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">&#39;lines&#39;</span>), <span class="at">max.overlaps =</span> <span class="dv">40</span>, <span class="at">box.padding =</span> <span class="fl">0.4</span>) <span class="sc">+</span> <span class="fu">stat_cor</span>(<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>, <span class="at">label.x =</span> <span class="dv">40000</span>, <span class="at">label.y =</span> <span class="dv">0</span>)</span>
<span id="cb182-66"><a href="cancer-epidemiology.html#cb182-66" tabindex="-1"></a></span>
<span id="cb182-67"><a href="cancer-epidemiology.html#cb182-67" tabindex="-1"></a>gmor<span class="ot">&lt;-</span><span class="fu">ggplot</span>(HKCancer_compare, <span class="fu">aes</span>(<span class="at">y=</span>grants, <span class="at">x=</span>mortality)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">scale_color_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span>  <span class="fu">geom_label_repel</span>(<span class="at">data=</span>HKCancer_compare, <span class="fu">aes</span>(<span class="at">label=</span>cancer),  <span class="at">nudge_x =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="fl">3.5</span>,<span class="at">label.size =</span> <span class="cn">NA</span> ,<span class="at">min.segment.length =</span><span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">&#39;lines&#39;</span>), <span class="at">max.overlaps =</span> <span class="dv">40</span>, <span class="at">box.padding =</span> <span class="fl">0.4</span>) <span class="sc">+</span> <span class="fu">stat_cor</span>(<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>, <span class="at">label.x =</span> <span class="dv">40000</span>, <span class="at">label.y =</span> <span class="dv">0</span>)</span>
<span id="cb182-68"><a href="cancer-epidemiology.html#cb182-68" tabindex="-1"></a></span>
<span id="cb182-69"><a href="cancer-epidemiology.html#cb182-69" tabindex="-1"></a><span class="fu">grid.arrange</span>(gp,ginc,gmor,pinc, pmor, <span class="at">ncol=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="BMDatSci_files/figure-html/grants%20versus%20incidence%20and%20mortality-1.png" width="960" /></p>
</div>
</div>
<div id="task-to-be-completed-in-tutotial-2-by-300pm-and-shared-with-other-tutorial-group" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> 5. Task (to be completed in Tutotial 2 by 3:00pm and shared with other tutorial group)<a href="cancer-epidemiology.html#task-to-be-completed-in-tutotial-2-by-300pm-and-shared-with-other-tutorial-group" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As a group, discuss what cancer type you think is most worthy of funding in Hong Kong. Prepare 2-3 PowerPoint/Google Slides summarising your decision. Include some points and figures supporting your final conclusion. If possible also include suggestions of what other data/analyses can be performed and/or other cancer types that are also in need of funding in Hong Kong.</p>


</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="pop-genetics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="install.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/statbiomed/BMDS-book/tree/main/02-data_topics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["BMDatSci.pdf", "BMDatSci.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
